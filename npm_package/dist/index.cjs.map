{"version":3,"file":"index.cjs","sources":["../src/shared/async-registry.ts","../src/shared/debounce.ts","../src/shared/filter-object-values.ts","../src/shared/is-empty-object.ts","../src/shared/map-object-values.ts","../src/shared/uid.ts","../src/shared/wait-for.ts","../src/shared/wait-for-dom-ready.ts","../src/elements/editor/utils/create-editor-in-context.ts","../src/elements/editor/utils/get-editor-roots-values.ts","../src/elements/editor/utils/is-single-root-editor.ts","../src/ckeditor5-symfony-error.ts","../src/elements/editor/utils/load-editor-constructor.ts","../src/elements/editor/custom-editor-plugins.ts","../src/elements/editor/utils/load-editor-plugins.ts","../src/elements/editor/utils/load-editor-translations.ts","../src/elements/editor/utils/normalize-custom-translations.ts","../src/elements/editor/utils/query-all-editor-ids.ts","../src/elements/editor/utils/query-editor-editables.ts","../src/elements/editor/utils/resolve-editor-config-elements-references.ts","../src/elements/editor/utils/resolve-editor-config-translations.ts","../src/elements/editor/utils/set-editor-editable-height.ts","../src/elements/editor/utils/wrap-with-watchdog.ts","../src/elements/context/contexts-registry.ts","../src/elements/context/context.ts","../src/elements/editor/editors-registry.ts","../src/elements/editable.ts","../src/elements/editor/plugins/dispatch-editor-roots-change-event.ts","../src/elements/editor/plugins/sync-editor-with-input.ts","../src/elements/editor/editor.ts","../src/elements/ui-part.ts","../src/elements/register-custom-elements.ts","../src/index.ts"],"sourcesContent":["/**\n * Generic async registry for objects with an async destroy method.\n * Provides a way to register, unregister, and execute callbacks on objects by ID.\n */\nexport class AsyncRegistry<T extends Destructible> {\n  /**\n   * Map of registered items.\n   */\n  private readonly items = new Map<RegistryId | null, T>();\n\n  /**\n   * Map of initialization errors for items that failed to register.\n   */\n  private readonly initializationErrors = new Map<RegistryId | null, any>();\n\n  /**\n   * Map of pending callbacks waiting for items to be registered or fail.\n   */\n  private readonly pendingCallbacks = new Map<RegistryId | null, PendingCallbacks<T>>();\n\n  /**\n   * Set of watchers that observe changes to the registry.\n   */\n  private readonly watchers = new Set<RegistryWatcher<T>>();\n\n  /**\n   * Executes a function on an item.\n   * If the item is not yet registered, it will wait for it to be registered.\n   *\n   * @param id The ID of the item.\n   * @param onSuccess The function to execute.\n   * @param onError Optional error callback.\n   * @returns A promise that resolves with the result of the function.\n   */\n  execute<R, E extends T = T>(\n    id: RegistryId | null,\n    onSuccess: (item: E) => R,\n    onError?: (error: any) => void,\n  ): Promise<Awaited<R>> {\n    const item = this.items.get(id);\n    const error = this.initializationErrors.get(id);\n\n    // If error exists and callback provided, invoke it immediately.\n    if (error) {\n      onError?.(error);\n      return Promise.reject(error);\n    }\n\n    // If item exists, invoke callback immediately (synchronously via Promise.resolve).\n    if (item) {\n      return Promise.resolve(onSuccess(item as E));\n    }\n\n    // Item not ready yet - queue the callbacks.\n    return new Promise((resolve, reject) => {\n      const pending = this.getPendingCallbacks(id);\n\n      pending.success.push(async (item: T) => {\n        resolve(await onSuccess(item as E));\n      });\n\n      if (onError) {\n        pending.error.push(onError);\n      }\n      else {\n        pending.error.push(reject);\n      }\n    });\n  }\n\n  /**\n   * Registers an item.\n   *\n   * @param id The ID of the item.\n   * @param item The item instance.\n   */\n  register(id: RegistryId | null, item: T): void {\n    if (this.items.has(id)) {\n      throw new Error(`Item with ID \"${id}\" is already registered.`);\n    }\n\n    this.resetErrors(id);\n    this.items.set(id, item);\n\n    // Execute all pending callbacks for this item (synchronously).\n    const pending = this.pendingCallbacks.get(id);\n\n    if (pending) {\n      pending.success.forEach(callback => callback(item));\n      this.pendingCallbacks.delete(id);\n    }\n\n    // Register the first item as the default item (null ID).\n    this.registerAsDefault(id, item);\n    this.notifyWatchers();\n  }\n\n  /**\n   * Registers an error for an item.\n   *\n   * @param id The ID of the item.\n   * @param error The error to register.\n   */\n  error(id: RegistryId | null, error: any): void {\n    this.items.delete(id);\n    this.initializationErrors.set(id, error);\n\n    // Execute all pending error callbacks for this item.\n    const pending = this.pendingCallbacks.get(id);\n\n    if (pending) {\n      pending.error.forEach(callback => callback(error));\n      this.pendingCallbacks.delete(id);\n    }\n\n    // Set as default error if this is the first error and no items exist.\n    if (this.initializationErrors.size === 1 && !this.items.size) {\n      this.error(null, error);\n    }\n\n    // Notify watchers about the error state.\n    this.notifyWatchers();\n  }\n\n  /**\n   * Resets errors for an item.\n   *\n   * @param id The ID of the item.\n   */\n  resetErrors(id: RegistryId | null): void {\n    const { initializationErrors } = this;\n\n    // Clear default error if it's the same as the specific error.\n    if (initializationErrors.has(null) && initializationErrors.get(null) === initializationErrors.get(id)) {\n      initializationErrors.delete(null);\n    }\n\n    initializationErrors.delete(id);\n  }\n\n  /**\n   * Un-registers an item.\n   *\n   * @param id The ID of the item.\n   */\n  unregister(id: RegistryId | null): void {\n    if (!this.items.has(id)) {\n      throw new Error(`Item with ID \"${id}\" is not registered.`);\n    }\n\n    // If unregistering the default item, clear it.\n    if (id && this.items.get(null) === this.items.get(id)) {\n      this.unregister(null);\n    }\n\n    this.items.delete(id);\n    this.pendingCallbacks.delete(id);\n\n    this.notifyWatchers();\n  }\n\n  /**\n   * Gets all registered items.\n   *\n   * @returns An array of all registered items.\n   */\n  getItems(): T[] {\n    return Array.from(this.items.values());\n  }\n\n  /**\n   * Checks if an item with the given ID is registered.\n   *\n   * @param id The ID of the item.\n   * @returns `true` if the item is registered, `false` otherwise.\n   */\n  hasItem(id: RegistryId | null): boolean {\n    return this.items.has(id);\n  }\n\n  /**\n   * Gets a promise that resolves with the item instance for the given ID.\n   * If the item is not registered yet, it will wait for it to be registered.\n   *\n   * @param id The ID of the item.\n   * @param timeout Optional timeout in milliseconds.\n   * @returns A promise that resolves with the item instance.\n   */\n  waitFor<E extends T = T>(id: RegistryId | null, timeout?: number): Promise<E> {\n    return new Promise<E>((resolve, reject) => {\n      let exceedTimeout = false;\n      let timer: ReturnType<typeof setTimeout> | null = null;\n\n      void this.execute(\n        id,\n        (value: E) => {\n          if (exceedTimeout) {\n            return;\n          }\n\n          if (timer !== null) {\n            clearTimeout(timer!);\n          }\n\n          (resolve as (value: E) => void)(value);\n        },\n        (error: any) => {\n          if (exceedTimeout) {\n            return;\n          }\n\n          if (timer !== null) {\n            clearTimeout(timer!);\n          }\n\n          reject(error);\n        },\n      );\n\n      if (timeout) {\n        timer = setTimeout(() => {\n          exceedTimeout = true;\n          reject(new Error(`Timeout waiting for item with ID \"${id}\" to be registered.`));\n        }, timeout);\n      }\n    });\n  }\n\n  /**\n   * Destroys all registered items and clears the registry.\n   * This will call the `destroy` method on each item.\n   */\n  async destroyAll() {\n    const promises = (\n      Array\n        .from(new Set(this.items.values()))\n        .map(item => item.destroy())\n    );\n\n    this.items.clear();\n    this.pendingCallbacks.clear();\n\n    await Promise.all(promises);\n\n    this.notifyWatchers();\n  }\n\n  /**\n   * Registers a watcher that will be called whenever the registry changes.\n   *\n   * @param watcher The watcher function to register.\n   * @returns A function to unregister the watcher.\n   */\n  watch(watcher: RegistryWatcher<T>): () => void {\n    this.watchers.add(watcher);\n\n    // Call the watcher immediately with the current state.\n    watcher(\n      new Map(this.items),\n      new Map(this.initializationErrors),\n    );\n\n    return this.unwatch.bind(this, watcher);\n  }\n\n  /**\n   * Un-registers a watcher.\n   *\n   * @param watcher The watcher function to unregister.\n   */\n  unwatch(watcher: RegistryWatcher<T>): void {\n    this.watchers.delete(watcher);\n  }\n\n  /**\n   * Resets the registry by clearing all items, errors, and pending callbacks.\n   */\n  reset(): void {\n    this.items.clear();\n    this.initializationErrors.clear();\n    this.pendingCallbacks.clear();\n    this.notifyWatchers();\n  }\n\n  /**\n   * Notifies all watchers about changes to the registry.\n   */\n  private notifyWatchers(): void {\n    this.watchers.forEach(\n      watcher => watcher(\n        new Map(this.items),\n        new Map(this.initializationErrors),\n      ),\n    );\n  }\n\n  /**\n   * Gets or creates pending callbacks for a specific ID.\n   *\n   * @param id The ID of the item.\n   * @returns The pending callbacks structure.\n   */\n  private getPendingCallbacks(id: RegistryId | null): PendingCallbacks<T> {\n    let pending = this.pendingCallbacks.get(id);\n\n    if (!pending) {\n      pending = { success: [], error: [] };\n      this.pendingCallbacks.set(id, pending);\n    }\n\n    return pending;\n  }\n\n  /**\n   * Registers an item as the default (null ID) item if it's the first one.\n   *\n   * @param id The ID of the item being registered.\n   * @param item The item instance.\n   */\n  private registerAsDefault(id: RegistryId | null, item: T): void {\n    if (this.items.size === 1 && id !== null) {\n      this.register(null, item);\n    }\n  }\n}\n\n/**\n * Interface for objects that can be destroyed.\n */\nexport type Destructible = {\n  destroy: () => Promise<any>;\n};\n\n/**\n * Identifier of the registry item.\n */\ntype RegistryId = string;\n\n/**\n * Structure holding pending success and error callbacks for an item.\n */\ntype PendingCallbacks<T> = {\n  success: Array<(item: T) => void>;\n  error: Array<(error: Error) => void>;\n};\n\n/**\n * Callback type for watching registry changes.\n */\ntype RegistryWatcher<T> = (\n  items: Map<RegistryId | null, T>,\n  errors: Map<RegistryId | null, Error>,\n) => void;\n","export function debounce<T extends (...args: any[]) => any>(\n  delay: number,\n  callback: T,\n): (...args: Parameters<T>) => void {\n  let timeoutId: ReturnType<typeof setTimeout> | null = null;\n\n  return (...args: Parameters<T>): void => {\n    if (timeoutId) {\n      clearTimeout(timeoutId);\n    }\n\n    timeoutId = setTimeout(() => {\n      callback(...args);\n    }, delay);\n  };\n}\n","/**\n * Filters the values of an object based on a provided filter function.\n *\n * @param obj The object to filter.\n * @param filter The filter function that determines whether a value should be included.\n * @returns A new object containing only the key-value pairs that passed the filter.\n */\nexport function filterObjectValues<T>(\n  obj: Record<string, T>,\n  filter: (value: T, key: string) => boolean,\n): Record<string, T> {\n  const filteredEntries = Object\n    .entries(obj)\n    .filter(([key, value]) => filter(value, key));\n\n  return Object.fromEntries(filteredEntries);\n}\n","export function isEmptyObject(obj: Record<string, unknown>): boolean {\n  return Object.keys(obj).length === 0 && obj.constructor === Object;\n}\n","/**\n * Maps the values of an object using a provided mapper function.\n *\n * @param obj The object whose values will be mapped.\n * @param mapper A function that takes a value and its key, and returns a new value.\n * @template T The type of the original values in the object.\n * @template U The type of the new values in the object.\n * @returns A new object with the same keys as the original, but with values transformed by\n */\nexport function mapObjectValues<T, U>(\n  obj: Record<string, T>,\n  mapper: (value: T, key: string) => U,\n): Record<string, U> {\n  const mappedEntries = Object\n    .entries(obj)\n    .map(([key, value]) => [key, mapper(value, key)] as const);\n\n  return Object.fromEntries(mappedEntries);\n}\n","/**\n * Generates a unique identifier string\n *\n * @returns Random string that can be used as unique identifier\n */\nexport function uid() {\n  return Math.random().toString(36).substring(2);\n}\n","import type { CanBePromise } from '../types';\n\n/**\n * Waits for the provided callback to succeed. The callback is executed multiple times until it succeeds or the timeout is reached.\n * It's executed immediately and then with a delay defined by the `retry` option.\n *\n * @param callback The callback to execute.\n * @param config Configuration for the function.\n * @param config.timeOutAfter The maximum time to wait for the callback to succeed, in milliseconds. Default is 500ms.\n * @param config.retryAfter The time to wait between retries, in milliseconds. Default is 100ms.\n * @returns A promise that resolves when the callback succeeds.\n */\nexport function waitFor<R>(\n  callback: () => CanBePromise<R>,\n  {\n    timeOutAfter = 500,\n    retryAfter = 100,\n  }: WaitForConfig = {},\n): Promise<R> {\n  return new Promise<R>((resolve, reject) => {\n    const startTime = Date.now();\n    let lastError: Error | null = null;\n\n    const timeoutTimerId = setTimeout(() => {\n      reject(lastError ?? new Error('Timeout'));\n    }, timeOutAfter);\n\n    const tick = async () => {\n      try {\n        const result = await callback();\n        clearTimeout(timeoutTimerId);\n        resolve(result);\n      }\n      catch (err: any) {\n        lastError = err;\n\n        if (Date.now() - startTime > timeOutAfter) {\n          reject(err);\n        }\n        else {\n          setTimeout(tick, retryAfter);\n        }\n      }\n    };\n\n    void tick();\n  });\n}\n\n/**\n * Configuration for the `waitFor` function.\n */\nexport type WaitForConfig = {\n  timeOutAfter?: number;\n  retryAfter?: number;\n};\n","/**\n * Returns a promise that resolves when the DOM is fully loaded and ready.\n */\nexport function waitForDOMReady(): Promise<void> {\n  return new Promise((resolve) => {\n    switch (document.readyState) {\n      case 'loading':\n        document.addEventListener('DOMContentLoaded', () => resolve(), { once: true });\n        break;\n\n      case 'interactive':\n      case 'complete':\n        setTimeout(resolve, 0);\n        break;\n\n      default:\n        console.warn('Unexpected document.readyState:', document.readyState);\n        setTimeout(resolve, 0);\n    }\n  });\n}\n","import type { Context, ContextWatchdog, Editor, EditorConfig } from 'ckeditor5';\n\nimport type { EditorCreator } from './wrap-with-watchdog';\n\nimport { uid } from '../../../shared';\n\n/**\n * Symbol used to store the context watchdog on the editor instance.\n * Internal use only.\n */\nconst CONTEXT_EDITOR_WATCHDOG_SYMBOL = Symbol.for('context-editor-watchdog');\n\n/**\n * Creates a CKEditor 5 editor instance within a given context watchdog.\n *\n * @param params Parameters for editor creation.\n * @param params.element The DOM element or data for the editor.\n * @param params.context The context watchdog instance.\n * @param params.creator The editor creator utility.\n * @param params.config The editor configuration object.\n * @returns The created editor instance.\n */\nexport async function createEditorInContext({ element, context, creator, config }: Attrs) {\n  const editorContextId = uid();\n\n  await context.add({\n    creator: (_element, _config) => creator.create(_element, _config),\n    id: editorContextId,\n    sourceElementOrData: element,\n    type: 'editor',\n    config,\n  });\n\n  const editor = context.getItem(editorContextId) as Editor;\n  const contextDescriptor: EditorContextDescriptor = {\n    state: 'available',\n    editorContextId,\n    context,\n  };\n\n  (editor as any)[CONTEXT_EDITOR_WATCHDOG_SYMBOL] = contextDescriptor;\n\n  // Destroying of context is async. There can be situation when the destroy of the context\n  // and the destroy of the editor is called in parallel. It often happens during unmounting of\n  // phoenix hooks. Let's make sure that descriptor informs other components, that context is being\n  // destroyed.\n  const originalDestroy = context.destroy.bind(context);\n  context.destroy = async () => {\n    contextDescriptor.state = 'unavailable';\n    return originalDestroy();\n  };\n\n  return {\n    ...contextDescriptor,\n    editor,\n  };\n}\n\n/**\n * Retrieves the context watchdog from an editor instance, if available.\n *\n * @param editor The editor instance.\n * @returns The context watchdog or null if not found.\n */\nexport function unwrapEditorContext(editor: Editor): EditorContextDescriptor | null {\n  if (CONTEXT_EDITOR_WATCHDOG_SYMBOL in editor) {\n    return (editor as any)[CONTEXT_EDITOR_WATCHDOG_SYMBOL];\n  }\n\n  return null;\n}\n\n/**\n * Parameters for creating an editor in a context.\n */\ntype Attrs = {\n  context: ContextWatchdog<Context>;\n  creator: EditorCreator;\n  element: HTMLElement;\n  config: EditorConfig;\n};\n\n/**\n * Descriptor for an editor context.\n */\ntype EditorContextDescriptor = {\n  state: 'available' | 'unavailable';\n  editorContextId: string;\n  context: ContextWatchdog<Context>;\n};\n","import type { Editor } from 'ckeditor5';\n\n/**\n * Gets values of all editor roots.\n *\n * @param editor The editor instance.\n * @returns A record where keys are root names and values are root HTML strings.\n */\nexport function getEditorRootsValues(editor: Editor): Record<string, string> {\n  return Array\n    .from(editor.model.document.getRoots())\n    .reduce<Record<string, string>>((acc, root) => {\n      if (root.rootName === '$graveyard') {\n        return acc;\n      }\n\n      acc[root.rootName] = editor.getData({ rootName: root.rootName });\n\n      return acc;\n    }, Object.create({}));\n}\n","import type { EditorType } from '../typings';\n\n/**\n * Checks if the given editor type is one of the single editing-like editors.\n *\n * @param editorType - The type of the editor to check.\n * @returns `true` if the editor type is 'inline', 'classic', or 'balloon', otherwise `false`.\n */\nexport function isSingleRootEditor(editorType: EditorType): boolean {\n  return ['inline', 'classic', 'balloon', 'decoupled'].includes(editorType);\n}\n","/**\n * Custom error class for CKEditor5 Symfony-related errors.\n */\nexport class CKEditor5SymfonyError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = 'CKEditor5SymfonyError';\n  }\n}\n","import type { EditorType } from '../typings';\n\nimport { CKEditor5SymfonyError } from '../../../ckeditor5-symfony-error';\n\n/**\n * Returns the constructor for the specified CKEditor5 editor type.\n *\n * @param type - The type of the editor to load.\n * @returns A promise that resolves to the editor constructor.\n */\nexport async function loadEditorConstructor(type: EditorType) {\n  const PKG = await import('ckeditor5');\n\n  const editorMap = {\n    inline: PKG.InlineEditor,\n    balloon: PKG.BalloonEditor,\n    classic: PKG.ClassicEditor,\n    decoupled: PKG.DecoupledEditor,\n    multiroot: PKG.MultiRootEditor,\n  } as const;\n\n  const EditorConstructor = editorMap[type];\n\n  if (!EditorConstructor) {\n    throw new CKEditor5SymfonyError(`Unsupported editor type: ${type}`);\n  }\n\n  return EditorConstructor;\n}\n","import type { PluginConstructor } from 'ckeditor5';\n\nimport type { CanBePromise } from '../../types';\n\nimport { CKEditor5SymfonyError } from '../../ckeditor5-symfony-error';\n\ntype PluginReader = () => CanBePromise<PluginConstructor>;\n\n/**\n * Registry for custom CKEditor plugins.\n * Allows registration and retrieval of custom plugins that can be used alongside built-in plugins.\n */\nexport class CustomEditorPluginsRegistry {\n  static readonly the = new CustomEditorPluginsRegistry();\n\n  /**\n   * Map of registered custom plugins.\n   */\n  private readonly plugins = new Map<string, PluginReader>();\n\n  /**\n   * Private constructor to enforce singleton pattern.\n   */\n  private constructor() {}\n\n  /**\n   * Registers a custom plugin for the CKEditor.\n   *\n   * @param name The name of the plugin.\n   * @param reader The plugin reader function that returns the plugin constructor.\n   * @returns A function to unregister the plugin.\n   */\n  register(name: string, reader: PluginReader): () => void {\n    if (this.plugins.has(name)) {\n      throw new CKEditor5SymfonyError(`Plugin with name \"${name}\" is already registered.`);\n    }\n\n    this.plugins.set(name, reader);\n\n    return this.unregister.bind(this, name);\n  }\n\n  /**\n   * Removes a custom plugin by its name.\n   *\n   * @param name The name of the plugin to unregister.\n   * @throws Will throw an error if the plugin is not registered.\n   */\n  unregister(name: string): void {\n    if (!this.plugins.has(name)) {\n      throw new CKEditor5SymfonyError(`Plugin with name \"${name}\" is not registered.`);\n    }\n\n    this.plugins.delete(name);\n  }\n\n  /**\n   * Removes all custom editor plugins.\n   * This is useful for cleanup in tests or when reloading plugins.\n   */\n  unregisterAll(): void {\n    this.plugins.clear();\n  }\n\n  /**\n   * Retrieves a custom plugin by its name.\n   *\n   * @param name The name of the plugin.\n   * @returns The plugin constructor or undefined if not found.\n   */\n  async get(name: string): Promise<PluginConstructor | undefined> {\n    const reader = this.plugins.get(name);\n\n    return reader?.();\n  }\n\n  /**\n   * Checks if a plugin with the given name is registered.\n   *\n   * @param name The name of the plugin.\n   * @returns `true` if the plugin is registered, `false` otherwise.\n   */\n  has(name: string): boolean {\n    return this.plugins.has(name);\n  }\n}\n","import type { PluginConstructor } from 'ckeditor5';\n\nimport type { EditorPlugin } from '../typings';\n\nimport { CKEditor5SymfonyError } from '../../../ckeditor5-symfony-error';\nimport { CustomEditorPluginsRegistry } from '../custom-editor-plugins';\n\n/**\n * Loads CKEditor plugins from base and premium packages.\n * First tries to load from the base 'ckeditor5' package, then falls back to 'ckeditor5-premium-features'.\n *\n * @param plugins - Array of plugin names to load\n * @returns Promise that resolves to an array of loaded Plugin instances\n * @throws Error if a plugin is not found in either package\n */\nexport async function loadEditorPlugins(plugins: EditorPlugin[]): Promise<LoadedPlugins> {\n  const basePackage = await import('ckeditor5');\n  let premiumPackage: Record<string, any> | null = null;\n\n  const loaders = plugins.map(async (plugin) => {\n    // Let's first try to load the plugin from the base package.\n    // Coverage is disabled due to Vitest issues with mocking dynamic imports.\n\n    // If the plugin is not found in the base package, try custom plugins.\n    const customPlugin = await CustomEditorPluginsRegistry.the.get(plugin);\n\n    if (customPlugin) {\n      return customPlugin;\n    }\n\n    // If not found, try to load from the base package.\n    const { [plugin]: basePkgImport } = basePackage as Record<string, unknown>;\n\n    if (basePkgImport) {\n      return basePkgImport as PluginConstructor;\n    }\n\n    // Plugin not found in base package, try premium package.\n    if (!premiumPackage) {\n      try {\n        premiumPackage = await import('ckeditor5-premium-features');\n        /* v8 ignore next 6 */\n      }\n      catch (error) {\n        console.error(`Failed to load premium package: ${error}`);\n        throw new CKEditor5SymfonyError(`Plugin \"${plugin}\" not found in base package and failed to load premium package.`);\n      }\n    }\n\n    /* v8 ignore next */\n    const { [plugin]: premiumPkgImport } = premiumPackage || {};\n\n    if (premiumPkgImport) {\n      return premiumPkgImport as PluginConstructor;\n    }\n\n    // Plugin not found in either package, throw an error.\n    throw new CKEditor5SymfonyError(`Plugin \"${plugin}\" not found in base or premium packages.`);\n  });\n\n  return {\n    loadedPlugins: await Promise.all(loaders),\n    hasPremium: !!premiumPackage,\n  };\n}\n\n/**\n * Type representing the loaded plugins and whether premium features are available.\n */\ntype LoadedPlugins = {\n  loadedPlugins: PluginConstructor<any>[];\n  hasPremium: boolean;\n};\n","import type { Translations } from 'ckeditor5';\n\n/**\n * Loads all required translations for the editor based on the language configuration.\n *\n * @param language - The language configuration object containing UI and content language codes.\n * @param language.ui - The UI language code.\n * @param language.content - The content language code.\n * @param hasPremium - Whether premium features are enabled and premium translations should be loaded.\n * @returns A promise that resolves to an array of loaded translation objects.\n */\nexport async function loadAllEditorTranslations(\n  language: { ui: string; content: string; },\n  hasPremium: boolean,\n): Promise<Translations[]> {\n  const translations = [language.ui, language.content];\n  const loadedTranslations = await Promise.all(\n    [\n      loadEditorPkgTranslations('ckeditor5', translations),\n      /* v8 ignore next */\n      hasPremium && loadEditorPkgTranslations('ckeditor5-premium-features', translations),\n    ].filter(pkg => !!pkg),\n  )\n    .then(translations => translations.flat());\n\n  return loadedTranslations;\n}\n\n/**\n * Loads the editor translations for the given languages.\n *\n * Make sure this function is properly compiled and bundled in self hosted environments!\n *\n * @param pkg - The package to load translations from ('ckeditor5' or 'ckeditor5-premium-features').\n * @param translations - The list of language codes to load translations for.\n * @returns A promise that resolves to an array of loaded translation packs.\n */\nasync function loadEditorPkgTranslations(\n  pkg: EditorPkgName,\n  translations: string[],\n) {\n  /* v8 ignore next */\n  return await Promise.all(\n    translations\n      .filter(lang => lang !== 'en') // 'en' is the default language, no need to load it.\n      .map(async (lang) => {\n        const pack = await loadEditorTranslation(pkg, lang);\n\n        /* v8 ignore next */\n        return pack?.default ?? pack;\n      })\n      .filter(Boolean),\n  );\n}\n\n/**\n * Type representing the package name for CKEditor 5.\n */\ntype EditorPkgName = 'ckeditor5' | 'ckeditor5-premium-features';\n\n/**\n * Load translation for CKEditor 5\n * @param pkg - Package type: 'ckeditor5' or 'premium'\n * @param lang - Language code (e.g., 'pl', 'en', 'de')\n * @returns Translation object or null if failed\n */\nasync function loadEditorTranslation(pkg: EditorPkgName, lang: string): Promise<any> {\n  try {\n    /* v8 ignore next 2 */\n    if (pkg === 'ckeditor5') {\n      /* v8 ignore next 79 */\n      switch (lang) {\n        case 'af': return await import('ckeditor5/translations/af.js');\n        case 'ar': return await import('ckeditor5/translations/ar.js');\n        case 'ast': return await import('ckeditor5/translations/ast.js');\n        case 'az': return await import('ckeditor5/translations/az.js');\n        case 'bg': return await import('ckeditor5/translations/bg.js');\n        case 'bn': return await import('ckeditor5/translations/bn.js');\n        case 'bs': return await import('ckeditor5/translations/bs.js');\n        case 'ca': return await import('ckeditor5/translations/ca.js');\n        case 'cs': return await import('ckeditor5/translations/cs.js');\n        case 'da': return await import('ckeditor5/translations/da.js');\n        case 'de': return await import('ckeditor5/translations/de.js');\n        case 'de-ch': return await import('ckeditor5/translations/de-ch.js');\n        case 'el': return await import('ckeditor5/translations/el.js');\n        case 'en': return await import('ckeditor5/translations/en.js');\n        case 'en-au': return await import('ckeditor5/translations/en-au.js');\n        case 'en-gb': return await import('ckeditor5/translations/en-gb.js');\n        case 'eo': return await import('ckeditor5/translations/eo.js');\n        case 'es': return await import('ckeditor5/translations/es.js');\n        case 'es-co': return await import('ckeditor5/translations/es-co.js');\n        case 'et': return await import('ckeditor5/translations/et.js');\n        case 'eu': return await import('ckeditor5/translations/eu.js');\n        case 'fa': return await import('ckeditor5/translations/fa.js');\n        case 'fi': return await import('ckeditor5/translations/fi.js');\n        case 'fr': return await import('ckeditor5/translations/fr.js');\n        case 'gl': return await import('ckeditor5/translations/gl.js');\n        case 'gu': return await import('ckeditor5/translations/gu.js');\n        case 'he': return await import('ckeditor5/translations/he.js');\n        case 'hi': return await import('ckeditor5/translations/hi.js');\n        case 'hr': return await import('ckeditor5/translations/hr.js');\n        case 'hu': return await import('ckeditor5/translations/hu.js');\n        case 'hy': return await import('ckeditor5/translations/hy.js');\n        case 'id': return await import('ckeditor5/translations/id.js');\n        case 'it': return await import('ckeditor5/translations/it.js');\n        case 'ja': return await import('ckeditor5/translations/ja.js');\n        case 'jv': return await import('ckeditor5/translations/jv.js');\n        case 'kk': return await import('ckeditor5/translations/kk.js');\n        case 'km': return await import('ckeditor5/translations/km.js');\n        case 'kn': return await import('ckeditor5/translations/kn.js');\n        case 'ko': return await import('ckeditor5/translations/ko.js');\n        case 'ku': return await import('ckeditor5/translations/ku.js');\n        case 'lt': return await import('ckeditor5/translations/lt.js');\n        case 'lv': return await import('ckeditor5/translations/lv.js');\n        case 'ms': return await import('ckeditor5/translations/ms.js');\n        case 'nb': return await import('ckeditor5/translations/nb.js');\n        case 'ne': return await import('ckeditor5/translations/ne.js');\n        case 'nl': return await import('ckeditor5/translations/nl.js');\n        case 'no': return await import('ckeditor5/translations/no.js');\n        case 'oc': return await import('ckeditor5/translations/oc.js');\n        case 'pl': return await import('ckeditor5/translations/pl.js');\n        case 'pt': return await import('ckeditor5/translations/pt.js');\n        case 'pt-br': return await import('ckeditor5/translations/pt-br.js');\n        case 'ro': return await import('ckeditor5/translations/ro.js');\n        case 'ru': return await import('ckeditor5/translations/ru.js');\n        case 'si': return await import('ckeditor5/translations/si.js');\n        case 'sk': return await import('ckeditor5/translations/sk.js');\n        case 'sl': return await import('ckeditor5/translations/sl.js');\n        case 'sq': return await import('ckeditor5/translations/sq.js');\n        case 'sr': return await import('ckeditor5/translations/sr.js');\n        case 'sr-latn': return await import('ckeditor5/translations/sr-latn.js');\n        case 'sv': return await import('ckeditor5/translations/sv.js');\n        case 'th': return await import('ckeditor5/translations/th.js');\n        case 'tk': return await import('ckeditor5/translations/tk.js');\n        case 'tr': return await import('ckeditor5/translations/tr.js');\n        case 'tt': return await import('ckeditor5/translations/tt.js');\n        case 'ug': return await import('ckeditor5/translations/ug.js');\n        case 'uk': return await import('ckeditor5/translations/uk.js');\n        case 'ur': return await import('ckeditor5/translations/ur.js');\n        case 'uz': return await import('ckeditor5/translations/uz.js');\n        case 'vi': return await import('ckeditor5/translations/vi.js');\n        case 'zh': return await import('ckeditor5/translations/zh.js');\n        case 'zh-cn': return await import('ckeditor5/translations/zh-cn.js');\n        default:\n          console.warn(`Language ${lang} not found in ckeditor5 translations`);\n          return null;\n      }\n    }\n    /* v8 ignore next 79 */\n    else {\n      // Premium features translations\n      switch (lang) {\n        case 'af': return await import('ckeditor5-premium-features/translations/af.js');\n        case 'ar': return await import('ckeditor5-premium-features/translations/ar.js');\n        case 'ast': return await import('ckeditor5-premium-features/translations/ast.js');\n        case 'az': return await import('ckeditor5-premium-features/translations/az.js');\n        case 'bg': return await import('ckeditor5-premium-features/translations/bg.js');\n        case 'bn': return await import('ckeditor5-premium-features/translations/bn.js');\n        case 'bs': return await import('ckeditor5-premium-features/translations/bs.js');\n        case 'ca': return await import('ckeditor5-premium-features/translations/ca.js');\n        case 'cs': return await import('ckeditor5-premium-features/translations/cs.js');\n        case 'da': return await import('ckeditor5-premium-features/translations/da.js');\n        case 'de': return await import('ckeditor5-premium-features/translations/de.js');\n        case 'de-ch': return await import('ckeditor5-premium-features/translations/de-ch.js');\n        case 'el': return await import('ckeditor5-premium-features/translations/el.js');\n        case 'en': return await import('ckeditor5-premium-features/translations/en.js');\n        case 'en-au': return await import('ckeditor5-premium-features/translations/en-au.js');\n        case 'en-gb': return await import('ckeditor5-premium-features/translations/en-gb.js');\n        case 'eo': return await import('ckeditor5-premium-features/translations/eo.js');\n        case 'es': return await import('ckeditor5-premium-features/translations/es.js');\n        case 'es-co': return await import('ckeditor5-premium-features/translations/es-co.js');\n        case 'et': return await import('ckeditor5-premium-features/translations/et.js');\n        case 'eu': return await import('ckeditor5-premium-features/translations/eu.js');\n        case 'fa': return await import('ckeditor5-premium-features/translations/fa.js');\n        case 'fi': return await import('ckeditor5-premium-features/translations/fi.js');\n        case 'fr': return await import('ckeditor5-premium-features/translations/fr.js');\n        case 'gl': return await import('ckeditor5-premium-features/translations/gl.js');\n        case 'gu': return await import('ckeditor5-premium-features/translations/gu.js');\n        case 'he': return await import('ckeditor5-premium-features/translations/he.js');\n        case 'hi': return await import('ckeditor5-premium-features/translations/hi.js');\n        case 'hr': return await import('ckeditor5-premium-features/translations/hr.js');\n        case 'hu': return await import('ckeditor5-premium-features/translations/hu.js');\n        case 'hy': return await import('ckeditor5-premium-features/translations/hy.js');\n        case 'id': return await import('ckeditor5-premium-features/translations/id.js');\n        case 'it': return await import('ckeditor5-premium-features/translations/it.js');\n        case 'ja': return await import('ckeditor5-premium-features/translations/ja.js');\n        case 'jv': return await import('ckeditor5-premium-features/translations/jv.js');\n        case 'kk': return await import('ckeditor5-premium-features/translations/kk.js');\n        case 'km': return await import('ckeditor5-premium-features/translations/km.js');\n        case 'kn': return await import('ckeditor5-premium-features/translations/kn.js');\n        case 'ko': return await import('ckeditor5-premium-features/translations/ko.js');\n        case 'ku': return await import('ckeditor5-premium-features/translations/ku.js');\n        case 'lt': return await import('ckeditor5-premium-features/translations/lt.js');\n        case 'lv': return await import('ckeditor5-premium-features/translations/lv.js');\n        case 'ms': return await import('ckeditor5-premium-features/translations/ms.js');\n        case 'nb': return await import('ckeditor5-premium-features/translations/nb.js');\n        case 'ne': return await import('ckeditor5-premium-features/translations/ne.js');\n        case 'nl': return await import('ckeditor5-premium-features/translations/nl.js');\n        case 'no': return await import('ckeditor5-premium-features/translations/no.js');\n        case 'oc': return await import('ckeditor5-premium-features/translations/oc.js');\n        case 'pl': return await import('ckeditor5-premium-features/translations/pl.js');\n        case 'pt': return await import('ckeditor5-premium-features/translations/pt.js');\n        case 'pt-br': return await import('ckeditor5-premium-features/translations/pt-br.js');\n        case 'ro': return await import('ckeditor5-premium-features/translations/ro.js');\n        case 'ru': return await import('ckeditor5-premium-features/translations/ru.js');\n        case 'si': return await import('ckeditor5-premium-features/translations/si.js');\n        case 'sk': return await import('ckeditor5-premium-features/translations/sk.js');\n        case 'sl': return await import('ckeditor5-premium-features/translations/sl.js');\n        case 'sq': return await import('ckeditor5-premium-features/translations/sq.js');\n        case 'sr': return await import('ckeditor5-premium-features/translations/sr.js');\n        case 'sr-latn': return await import('ckeditor5-premium-features/translations/sr-latn.js');\n        case 'sv': return await import('ckeditor5-premium-features/translations/sv.js');\n        case 'th': return await import('ckeditor5-premium-features/translations/th.js');\n        case 'tk': return await import('ckeditor5-premium-features/translations/tk.js');\n        case 'tr': return await import('ckeditor5-premium-features/translations/tr.js');\n        case 'tt': return await import('ckeditor5-premium-features/translations/tt.js');\n        case 'ug': return await import('ckeditor5-premium-features/translations/ug.js');\n        case 'uk': return await import('ckeditor5-premium-features/translations/uk.js');\n        case 'ur': return await import('ckeditor5-premium-features/translations/ur.js');\n        case 'uz': return await import('ckeditor5-premium-features/translations/uz.js');\n        case 'vi': return await import('ckeditor5-premium-features/translations/vi.js');\n        case 'zh': return await import('ckeditor5-premium-features/translations/zh.js');\n        case 'zh-cn': return await import('ckeditor5-premium-features/translations/zh-cn.js');\n        default:\n          console.warn(`Language ${lang} not found in premium translations`);\n          return await import('ckeditor5-premium-features/translations/en.js'); // fallback to English\n      }\n    }\n    /* v8 ignore next 7 */\n  }\n  catch (error) {\n    console.error(`Failed to load translation for ${pkg}/${lang}:`, error);\n    return null;\n  }\n}\n","import type { Translations } from 'ckeditor5';\n\nimport type { EditorCustomTranslationsDictionary } from '../typings';\n\nimport { mapObjectValues } from '../../../shared';\n\n/**\n * This function takes a custom translations object and maps it to the format expected by CKEditor5.\n * Each translation dictionary is wrapped in an object with a `dictionary` key.\n *\n * @param translations - The custom translations to normalize.\n * @returns A normalized translations object suitable for CKEditor5.\n */\nexport function normalizeCustomTranslations(translations: EditorCustomTranslationsDictionary): Translations {\n  return mapObjectValues(translations, dictionary => ({\n    dictionary,\n  }));\n}\n","/**\n * Queries all CKEditor 5 editor IDs present in the document.\n */\nexport function queryAllEditorIds(): string[] {\n  return Array\n    .from(document.querySelectorAll<HTMLElement>('cke5-editor'))\n    .map(element => element.getAttribute('data-cke-editor-id'))\n    .filter((id): id is string => id !== null);\n}\n","import type { EditorId } from '../typings';\n\nimport { filterObjectValues, mapObjectValues } from '../../../shared';\n\n/**\n * Gets the initial root elements for the editor based on its type.\n *\n * @param editorId The editor's ID.\n * @returns The root element(s) for the editor.\n */\nexport function queryEditablesElements(editorId: EditorId) {\n  const editables = queryAllEditorEditables(editorId);\n\n  return mapObjectValues(editables, ({ element }) => element);\n}\n\n/**\n * Gets the initial data for the roots of the editor. If the editor is a single editing-like editor,\n * it retrieves the initial value from the element's attribute. Otherwise, it returns an object mapping\n * editable names to their initial values.\n *\n * @param editorId The editor's ID.\n * @returns The initial values for the editor's roots.\n */\nexport function queryEditablesSnapshotContent(editorId: EditorId) {\n  const editables = queryAllEditorEditables(editorId);\n  const values = mapObjectValues(editables, ({ content }) => content);\n\n  return filterObjectValues(values, value => typeof value === 'string') as Record<string, string>;\n}\n\n/**\n * Queries all editable elements within a specific editor instance. It picks\n * initial values from actually rendered elements or from the editor container's.\n *\n * It may differ from the `initialData` used during editor creation, as it might\n * not set all roots or set different values.\n *\n * @param editorId The ID of the editor to query.\n * @returns An object mapping editable names to their corresponding elements and initial values.\n */\nfunction queryAllEditorEditables(editorId: EditorId) {\n  const acc = (\n    Array\n      .from(document.querySelectorAll<HTMLElement>(`cke5-editable[data-cke-editor-id=\"${editorId}\"]`))\n      .reduce<Record<string, EditableItem>>((acc, element) => {\n        const rootName = element.getAttribute('data-cke-root-name')!;\n        const content = element.getAttribute('data-cke-content');\n\n        acc[rootName] = {\n          element: element.querySelector<HTMLElement>('[data-cke-editable-content]')!,\n          content,\n        };\n\n        return acc;\n      }, Object.create({}))\n  );\n\n  const editor = document.querySelector<HTMLElement>(`cke5-editor[data-cke-editor-id=\"${editorId}\"]`);\n\n  /* v8 ignore next 3 */\n  if (!editor) {\n    return acc;\n  }\n\n  const currentMain = acc['main'];\n  const initialRootEditableValue = JSON.parse(editor.getAttribute('data-cke-content')!);\n  const contentElement = document.querySelector<HTMLElement>(`#${editorId}_editor `);\n\n  // If found `main` editable, but it has no content, try to fill it from the editor container.\n  if (currentMain && initialRootEditableValue?.['main']) {\n    return {\n      ...acc,\n      main: {\n        ...currentMain,\n        content: currentMain.content || initialRootEditableValue['main'],\n      },\n    };\n  }\n\n  // If no `main` editable found, try to create it from the editor container.\n  if (contentElement) {\n    return {\n      ...acc,\n      main: {\n        element: contentElement,\n        content: initialRootEditableValue?.['main'] || null,\n      },\n    };\n  }\n\n  return acc;\n}\n\n/**\n * Type representing an editable item within an editor.\n */\nexport type EditableItem = {\n  element: HTMLElement;\n  content: string | null;\n};\n","/**\n * Resolves element references in configuration object.\n * Looks for objects with { $element: \"selector\" } format and replaces them with actual DOM elements.\n *\n * @param obj - Configuration object to process\n * @returns Processed configuration object with resolved element references\n */\nexport function resolveEditorConfigElementReferences<T>(obj: T): T {\n  if (!obj || typeof obj !== 'object') {\n    return obj;\n  }\n\n  if (Array.isArray(obj)) {\n    return obj.map(item => resolveEditorConfigElementReferences(item)) as T;\n  }\n\n  const anyObj = obj as any;\n\n  if (anyObj.$element && typeof anyObj.$element === 'string') {\n    const element = document.querySelector(anyObj.$element);\n\n    if (!element) {\n      console.warn(`Element not found for selector: ${anyObj.$element}`);\n    }\n\n    return (element || null) as T;\n  }\n\n  const result = Object.create(null);\n\n  for (const [key, value] of Object.entries(obj)) {\n    result[key] = resolveEditorConfigElementReferences(value);\n  }\n\n  return result as T;\n}\n","import type { Translations } from 'ckeditor5';\n\n/**\n * Resolves translation references in a configuration object.\n *\n * The configuration may contain objects with the form `{ $translation: \"some.key\" }`.\n * These are replaced with the actual string from the provided translations map.\n *\n * The function will walk the provided object recursively, handling arrays and\n * nested objects. Primitive values are returned as-is. If a translation key is\n * not present in the map, a warning is logged and `null` is returned for that\n * value.\n *\n * @param translations - An array of CKEditor `Translations` objects. Each translation\n *                       pack will be searched in order for the requested key, and the\n *                       first matching value will be returned. This mirrors the format\n *                       returned by `loadAllEditorTranslations` and simplifies the\n *                       caller's API.\n * @param language - Language identifier to look up in the packs. Only this locale\n *                   will be consulted, ensuring that keys from other languages are\n *                   ignored even if they appear earlier in the array.\n * @param obj - Configuration object to process\n * @returns Processed configuration object with resolved translations.\n */\nexport function resolveEditorConfigTranslations<T>(\n  translations: Translations[],\n  language: string,\n  obj: T,\n): T {\n  if (!obj || typeof obj !== 'object') {\n    return obj;\n  }\n\n  if (Array.isArray(obj)) {\n    return obj.map(item => resolveEditorConfigTranslations(translations, language, item)) as T;\n  }\n\n  const anyObj = obj as any;\n\n  if (anyObj.$translation && typeof anyObj.$translation === 'string') {\n    const key: string = anyObj.$translation;\n    const value = getTranslationValue(translations, key, language);\n\n    if (value === undefined) {\n      console.warn(`Translation not found for key: ${key}`);\n    }\n\n    return (value !== undefined ? value : null) as T;\n  }\n\n  const result = Object.create(null);\n\n  for (const [key, value] of Object.entries(obj)) {\n    result[key] = resolveEditorConfigTranslations(translations, language, value);\n  }\n\n  return result as T;\n}\n\n/**\n * Look up a translation value inside the provided map or array of CKEditor packs.\n */\nfunction getTranslationValue(\n  translations: Translations[],\n  key: string,\n  language: string,\n): string | ReadonlyArray<string> | undefined {\n  for (const pack of translations) {\n    const langData = pack[language];\n\n    if (langData?.dictionary && key in langData.dictionary) {\n      return langData.dictionary[key] as string | ReadonlyArray<string>;\n    }\n  }\n\n  return undefined;\n}\n","import type { Editor } from 'ckeditor5';\n\n/**\n * Sets the height of the editable area in the CKEditor instance.\n *\n * @param instance - The CKEditor instance to modify.\n * @param height - The height in pixels to set for the editable area.\n */\nexport function setEditorEditableHeight(instance: Editor, height: number): void {\n  const { editing } = instance;\n\n  editing.view.change((writer) => {\n    writer.setStyle('height', `${height}px`, editing.view.document.getRoot()!);\n  });\n}\n","import type { Editor, EditorWatchdog } from 'ckeditor5';\n\nconst EDITOR_WATCHDOG_SYMBOL = Symbol.for('elixir-editor-watchdog');\n\n/**\n * Wraps an Editor creator with a watchdog for automatic recovery.\n *\n * @param Editor - The Editor creator to wrap.\n * @returns The Editor creator wrapped with a watchdog.\n */\nexport async function wrapWithWatchdog(Editor: EditorCreator) {\n  const { EditorWatchdog } = await import('ckeditor5');\n  const watchdog = new EditorWatchdog(Editor);\n\n  watchdog.setCreator(async (...args: Parameters<typeof Editor['create']>) => {\n    const editor = await Editor.create(...args);\n\n    (editor as any)[EDITOR_WATCHDOG_SYMBOL] = watchdog;\n\n    return editor;\n  });\n\n  return {\n    watchdog,\n    Constructor: {\n      create: async (...args: Parameters<typeof Editor['create']>) => {\n        await watchdog.create(...args);\n\n        return watchdog.editor!;\n      },\n    },\n  };\n}\n\n/**\n * Unwraps the EditorWatchdog from the editor instance.\n */\nexport function unwrapEditorWatchdog(editor: Editor): EditorWatchdog | null {\n  if (EDITOR_WATCHDOG_SYMBOL in editor) {\n    return (editor as any)[EDITOR_WATCHDOG_SYMBOL] as EditorWatchdog;\n  }\n\n  return null;\n}\n\n/**\n * Type representing an Editor creator with a create method.\n */\nexport type EditorCreator = {\n  create: (...args: any) => Promise<Editor>;\n};\n","import type { Context, ContextWatchdog } from 'ckeditor5';\n\nimport { AsyncRegistry } from '../../shared';\n\n/**\n * It provides a way to register contexts and execute callbacks on them when they are available.\n */\nexport class ContextsRegistry extends AsyncRegistry<ContextWatchdog<Context>> {\n  static readonly the = new ContextsRegistry();\n}\n","import type { Context, ContextWatchdog } from 'ckeditor5';\n\nimport type { EditorLanguage } from '../editor';\nimport type { ContextConfig } from './typings';\n\nimport { isEmptyObject, waitForDOMReady } from '../../shared';\nimport {\n  loadAllEditorTranslations,\n  loadEditorPlugins,\n  normalizeCustomTranslations,\n  resolveEditorConfigElementReferences,\n  resolveEditorConfigTranslations,\n} from '../editor/utils';\nimport { ContextsRegistry } from './contexts-registry';\n\n/**\n * The Symfony hook that mounts CKEditor context instances.\n */\nexport class ContextComponentElement extends HTMLElement {\n  /**\n   * The promise that resolves to the context instance.\n   */\n  private contextPromise: Promise<ContextWatchdog<Context>> | null = null;\n\n  /**\n   * Mounts the context component.\n   */\n  async connectedCallback() {\n    await waitForDOMReady();\n\n    const contextId = this.getAttribute('data-cke-context-id')!;\n    const language = JSON.parse(this.getAttribute('data-cke-language')!) as EditorLanguage;\n    const contextConfig = JSON.parse(this.getAttribute('data-cke-context')!) as ContextConfig;\n\n    const { customTranslations, watchdogConfig, config: { plugins, ...config } } = contextConfig;\n    const { loadedPlugins, hasPremium } = await loadEditorPlugins(plugins ?? []);\n\n    // Mix custom translations with loaded translations.\n    const loadedTranslations = await loadAllEditorTranslations(language, hasPremium);\n    const mixedTranslations = [\n      ...loadedTranslations,\n      normalizeCustomTranslations(customTranslations || {}),\n    ]\n      .filter(translations => !isEmptyObject(translations));\n\n    // Initialize context with watchdog.\n    this.contextPromise = (async () => {\n      const { ContextWatchdog, Context } = await import('ckeditor5');\n\n      const instance = new ContextWatchdog(Context, {\n        crashNumberLimit: 10,\n        ...watchdogConfig,\n      });\n\n      // Construct parsed config. First resolve DOM element references in the provided configuration.\n      let resolvedConfig = resolveEditorConfigElementReferences(config);\n\n      // Then resolve translation references in the provided configuration, using the mixed translations.\n      resolvedConfig = resolveEditorConfigTranslations(\n        [...mixedTranslations].reverse(),\n        language.ui,\n        resolvedConfig,\n      );\n\n      await instance.create({\n        ...resolvedConfig,\n        language,\n        plugins: loadedPlugins,\n        ...mixedTranslations.length && {\n          translations: mixedTranslations,\n        },\n      });\n\n      instance.on('itemError', (...args) => {\n        console.error('Context item error:', ...args);\n      });\n\n      return instance;\n    })();\n\n    const context = await this.contextPromise;\n\n    if (this.isConnected) {\n      ContextsRegistry.the.register(contextId, context);\n    }\n  }\n\n  /**\n   * Destroys the context component. Unmounts root from the editor.\n   */\n  async disconnectedCallback() {\n    const contextId = this.getAttribute('data-cke-context-id');\n\n    // Let's hide the element during destruction to prevent flickering.\n    this.style.display = 'none';\n\n    // Let's wait for the mounted promise to resolve before proceeding with destruction.\n    try {\n      const context = await this.contextPromise;\n\n      await context?.destroy();\n    }\n    finally {\n      this.contextPromise = null;\n\n      if (contextId && ContextsRegistry.the.hasItem(contextId)) {\n        ContextsRegistry.the.unregister(contextId);\n      }\n    }\n  }\n}\n","import type { Editor } from 'ckeditor5';\n\nimport { AsyncRegistry } from '../../shared/async-registry';\n\n/**\n * It provides a way to register editors and execute callbacks on them when they are available.\n */\nexport class EditorsRegistry extends AsyncRegistry<Editor> {\n  static readonly the = new EditorsRegistry();\n}\n","import type { MultiRootEditor } from 'ckeditor5';\n\nimport { CKEditor5SymfonyError } from '../ckeditor5-symfony-error';\nimport { debounce, waitForDOMReady } from '../shared';\nimport { EditorsRegistry } from './editor/editors-registry';\nimport { queryAllEditorIds } from './editor/utils';\n\n/**\n * Editable hook for Symfony. It allows you to create editables for multi-root editors.\n */\nexport class EditableComponentElement extends HTMLElement {\n  /**\n   * The promise that resolves when the editable is mounted.\n   */\n  private editorPromise: Promise<MultiRootEditor | null> | null = null;\n\n  /**\n   * Mounts the editable component.\n   */\n  async connectedCallback() {\n    await waitForDOMReady();\n\n    if (!this.hasAttribute('data-cke-editor-id')) {\n      this.setAttribute('data-cke-editor-id', queryAllEditorIds()[0]!);\n    }\n\n    const editorId = this.getAttribute('data-cke-editor-id');\n    const rootName = this.getAttribute('data-cke-root-name');\n    const content = this.getAttribute('data-cke-content');\n    const saveDebounceMs = Number.parseInt(this.getAttribute('data-cke-save-debounce-ms')!, 10);\n\n    /* v8 ignore next 3 */\n    if (!editorId || !rootName) {\n      throw new CKEditor5SymfonyError('Editor ID or Root Name is missing.');\n    }\n\n    // If the editor is not registered yet, we will wait for it to be registered.\n    this.style.display = 'block';\n    this.editorPromise = EditorsRegistry.the.execute(editorId, async (editor: MultiRootEditor) => {\n      if (!this.isConnected) {\n        return null;\n      }\n\n      const input = this.querySelector('input') as HTMLInputElement | null;\n      const { ui, editing, model } = editor;\n\n      if (model.document.getRoot(rootName)) {\n        // If the newly added root already exists, but the newly added editable has content,\n        // we need to update the root data with the editable content.\n        if (content !== null) {\n          const data = editor.getData({ rootName });\n\n          if (data && data !== content) {\n            editor.setData({\n              [rootName]: content,\n            });\n          }\n        }\n\n        return editor;\n      }\n\n      editor.addRoot(rootName, {\n        isUndoable: false,\n        ...content !== null && {\n          data: content,\n        },\n      });\n\n      const contentElement = this.querySelector('[data-cke-editable-content]') as HTMLElement | null;\n      const editable = ui.view.createEditable(rootName, contentElement!);\n\n      ui.addEditable(editable);\n      editing.view.forceRender();\n\n      // Sync data with socket and input element.\n      const sync = () => {\n        const html = editor.getData({ rootName });\n\n        if (input) {\n          input.value = html;\n          input.dispatchEvent(new Event('input'));\n        }\n\n        this.dispatchEvent(new CustomEvent('change', { detail: { value: html } }));\n      };\n\n      editor.model.document.on('change:data', debounce(saveDebounceMs, sync));\n      sync();\n\n      return editor;\n    });\n  }\n\n  /**\n   * Destroys the editable component. Unmounts root from the editor.\n   */\n  async disconnectedCallback() {\n    const rootName = this.getAttribute('data-cke-root-name');\n\n    // Let's hide the element during destruction to prevent flickering.\n    this.style.display = 'none';\n\n    // Let's wait for the mounted promise to resolve before proceeding with destruction.\n    const editor = await this.editorPromise;\n    this.editorPromise = null;\n\n    // Unmount root from the editor if editor is still registered.\n    if (editor && editor.state !== 'destroyed' && rootName) {\n      const root = editor.model.document.getRoot(rootName);\n\n      if (root && 'detachEditable' in editor) {\n        try {\n          editor.detachEditable(root);\n        }\n        catch (err) {\n          // Ignore errors when detaching editable.\n          console.error('Unable unmount editable from root:', err);\n        }\n\n        editor.detachRoot(rootName, false);\n      }\n    }\n  }\n}\n","import type { PluginConstructor } from 'ckeditor5';\n\nimport { debounce } from '../../../shared';\nimport { getEditorRootsValues } from '../utils';\n\n/**\n * Creates a DispatchEditorRootsChangeEvent plugin class.\n */\nexport async function createDispatchEditorRootsChangeEventPlugin(\n  {\n    saveDebounceMs,\n    editorId,\n    targetElement,\n  }: CreateDispatchEditorRootsChangeEventPluginParams,\n): Promise<PluginConstructor> {\n  const { Plugin } = await import('ckeditor5');\n\n  return class DispatchEditorRootsChangeEvent extends Plugin {\n    /**\n     * The name of the plugin.\n     */\n    static get pluginName() {\n      return 'DispatchEditorRootsChangeEvent' as const;\n    }\n\n    /**\n     * Initializes the plugin.\n     */\n    public afterInit(): void {\n      const sync = debounce(saveDebounceMs, this.dispatch);\n\n      this.editor.model.document.on('change:data', sync);\n      this.editor.once('ready', this.dispatch);\n    }\n\n    /**\n     * Dispatches a custom event with all roots data.\n     */\n    private dispatch = (): void => {\n      targetElement.dispatchEvent(\n        new CustomEvent('ckeditor5:change:data', {\n          detail: {\n            editorId,\n            editor: this.editor,\n            roots: getEditorRootsValues(this.editor),\n          },\n          bubbles: true,\n        }),\n      );\n    };\n  };\n}\n\ntype CreateDispatchEditorRootsChangeEventPluginParams = {\n  saveDebounceMs: number;\n  editorId: string;\n  targetElement: HTMLElement;\n};\n","import type { ClassicEditor, PluginConstructor } from 'ckeditor5';\n\nimport { debounce } from '../../../shared';\n\n/**\n * Creates a SyncEditorWithInput plugin class.\n */\nexport async function createSyncEditorWithInputPlugin(saveDebounceMs: number): Promise<PluginConstructor> {\n  const { Plugin } = await import('ckeditor5');\n\n  return class SyncEditorWithInput extends Plugin {\n    /**\n     * The input element to synchronize with.\n     */\n    private input: HTMLInputElement | null = null;\n\n    /**\n     * The form element reference for cleanup.\n     */\n    private form: HTMLFormElement | null = null;\n\n    /**\n     * The name of the plugin.\n     */\n    static get pluginName() {\n      return 'SyncEditorWithInput' as const;\n    }\n\n    /**\n     * Initializes the plugin.\n     */\n    public afterInit(): void {\n      const { editor } = this;\n      const editorElement = (editor as ClassicEditor).sourceElement as HTMLElement;\n\n      // Try to find the associated input field.\n      const editorId = editorElement.id.replace(/_editor$/, '');\n\n      this.input = document.getElementById(`${editorId}_input`) as HTMLInputElement | null;\n\n      if (!this.input) {\n        return;\n      }\n\n      // Setup handlers.\n      editor.model.document.on('change:data', debounce(saveDebounceMs, () => this.sync()));\n      editor.once('ready', this.sync);\n\n      // Setup form integration.\n      this.form = this.input.closest('form');\n      this.form?.addEventListener('submit', this.sync);\n    }\n\n    /**\n     * Synchronizes the editor's content with the input field.\n     */\n    private sync = (): void => {\n      if (this.input) {\n        const newValue = this.editor.getData();\n\n        this.input.value = newValue;\n        this.input.dispatchEvent(new Event('input', { bubbles: true }));\n      }\n    };\n\n    /**\n     * Destroys the plugin.\n     */\n    public override destroy(): void {\n      if (this.form) {\n        this.form.removeEventListener('submit', this.sync);\n      }\n\n      this.input = null;\n      this.form = null;\n    }\n  };\n}\n","import type { Editor } from 'ckeditor5';\n\nimport type { EditorId, EditorLanguage, EditorPreset } from './typings';\nimport type { EditorCreator } from './utils';\n\nimport { isEmptyObject, waitFor, waitForDOMReady } from '../../shared';\nimport { ContextsRegistry } from '../context';\nimport { EditorsRegistry } from './editors-registry';\nimport {\n  createDispatchEditorRootsChangeEventPlugin,\n  createSyncEditorWithInputPlugin,\n} from './plugins';\nimport {\n  createEditorInContext,\n  isSingleRootEditor,\n  loadAllEditorTranslations,\n  loadEditorConstructor,\n  loadEditorPlugins,\n  normalizeCustomTranslations,\n  queryEditablesElements,\n  queryEditablesSnapshotContent,\n  resolveEditorConfigElementReferences,\n  resolveEditorConfigTranslations,\n  setEditorEditableHeight,\n  unwrapEditorContext,\n  unwrapEditorWatchdog,\n  wrapWithWatchdog,\n} from './utils';\n\n/**\n * The Symfony hook that manages the lifecycle of CKEditor5 instances.\n */\nexport class EditorComponentElement extends HTMLElement {\n  /**\n   * The promise that resolves to the editor instance.\n   */\n  private editorPromise: Promise<Editor> | null = null;\n\n  /**\n   * Mounts the editor component.\n   */\n  async connectedCallback(): Promise<void> {\n    await waitForDOMReady();\n\n    const editorId = this.getAttribute('data-cke-editor-id')!;\n\n    EditorsRegistry.the.resetErrors(editorId);\n\n    try {\n      this.style.display = 'block';\n      this.editorPromise = this.createEditor();\n\n      const editor = await this.editorPromise;\n\n      // Do not even try to broadcast about the registration of the editor\n      // if hook was immediately destroyed.\n      if (this.isConnected) {\n        EditorsRegistry.the.register(editorId, editor);\n\n        editor.once('destroy', () => {\n          if (EditorsRegistry.the.hasItem(editorId)) {\n            EditorsRegistry.the.unregister(editorId);\n          }\n        });\n      }\n      /* v8 ignore next 6 */\n    }\n    catch (error: any) {\n      console.error(`Error initializing CKEditor5 instance with ID \"${editorId}\":`, error);\n      this.editorPromise = null;\n      EditorsRegistry.the.error(editorId, error);\n    }\n  }\n\n  /**\n   * Destroys the editor instance when the component is destroyed.\n   * This is important to prevent memory leaks and ensure that the editor is properly cleaned up.\n   */\n  async disconnectedCallback() {\n    // Let's hide the element during destruction to prevent flickering.\n    this.style.display = 'none';\n\n    // Let's wait for the mounted promise to resolve before proceeding with destruction.\n    try {\n      const editor = await this.editorPromise;\n\n      /* v8 ignore next 3 */\n      if (!editor) {\n        return;\n      }\n\n      const editorContext = unwrapEditorContext(editor);\n      const watchdog = unwrapEditorWatchdog(editor);\n\n      if (editorContext) {\n        // If context is present, make sure it's not in unmounting phase, as it'll kill the editors.\n        // If it's being destroyed, don't do anything, as the context will take care of it.\n        if (editorContext.state !== 'unavailable') {\n          await editorContext.context.remove(editorContext.editorContextId);\n        }\n      }\n      else if (watchdog) {\n        await watchdog.destroy();\n      }\n      else {\n        await editor.destroy();\n      }\n    }\n    finally {\n      this.editorPromise = null;\n    }\n  }\n\n  /**\n   * Creates the CKEditor instance.\n   */\n  private async createEditor() {\n    const editorId = this.getAttribute('data-cke-editor-id')!;\n    const preset = JSON.parse(this.getAttribute('data-cke-preset')!) as EditorPreset;\n    const contextId = this.getAttribute('data-cke-context-id');\n    const editableHeight = this.getAttribute('data-cke-editable-height') ? Number.parseInt(this.getAttribute('data-cke-editable-height')!, 10) : null;\n    const saveDebounceMs = Number.parseInt(this.getAttribute('data-cke-save-debounce-ms')!, 10);\n    const language = JSON.parse(this.getAttribute('data-cke-language')!) as EditorLanguage;\n    const watchdog = this.hasAttribute('data-cke-watchdog');\n    const content = JSON.parse(this.getAttribute('data-cke-content')!) as Record<string, string>;\n\n    const {\n      customTranslations,\n      editorType,\n      licenseKey,\n      config: { plugins, ...config },\n    } = preset;\n\n    // Wrap editor creator with watchdog if needed.\n    let Constructor: EditorCreator = await loadEditorConstructor(editorType);\n    const context = await (\n      contextId\n        ? ContextsRegistry.the.waitFor(contextId)\n        : null\n    );\n\n    // Do not use editor specific watchdog if context is attached, as the context is by default protected.\n    if (watchdog && !context) {\n      const wrapped = await wrapWithWatchdog(Constructor);\n\n      ({ Constructor } = wrapped);\n      wrapped.watchdog.on('restart', () => {\n        const newInstance = wrapped.watchdog.editor!;\n\n        this.editorPromise = Promise.resolve(newInstance);\n\n        EditorsRegistry.the.register(editorId, newInstance);\n      });\n    }\n\n    const { loadedPlugins, hasPremium } = await loadEditorPlugins(plugins);\n\n    loadedPlugins.push(\n      await createDispatchEditorRootsChangeEventPlugin({\n        saveDebounceMs,\n        editorId,\n        targetElement: this,\n      }),\n    );\n\n    if (isSingleRootEditor(editorType)) {\n      loadedPlugins.push(\n        await createSyncEditorWithInputPlugin(saveDebounceMs),\n      );\n    }\n\n    // Mix custom translations with loaded translations.\n    const loadedTranslations = await loadAllEditorTranslations(language, hasPremium);\n    const mixedTranslations = [\n      ...loadedTranslations,\n      normalizeCustomTranslations(customTranslations || {}),\n    ]\n      .filter(translations => !isEmptyObject(translations));\n\n    // Let's query all elements, and create basic configuration.\n    let initialData: string | Record<string, string> = {\n      ...content,\n      ...queryEditablesSnapshotContent(editorId),\n    };\n\n    if (isSingleRootEditor(editorType)) {\n      initialData = initialData['main'] || '';\n    }\n\n    // Depending of the editor type, and parent lookup for nearest context or initialize it without it.\n    const editor = await (async () => {\n      let sourceElementOrData: HTMLElement | Record<string, HTMLElement> = queryEditablesElements(editorId);\n\n      // Handle special case when user specified `initialData` of several root elements, but editable components\n      // are not yet present in the DOM. In other words - editor is initialized before attaching root elements.\n      if (!sourceElementOrData['main']) {\n        const requiredRoots = (\n          isSingleRootEditor(editorType)\n            ? ['main']\n            : Object.keys(initialData as Record<string, string>)\n        );\n\n        if (!checkIfAllRootsArePresent(sourceElementOrData, requiredRoots)) {\n          sourceElementOrData = await waitForAllRootsToBePresent(editorId, requiredRoots);\n          initialData = {\n            ...content,\n            ...queryEditablesSnapshotContent(editorId),\n          };\n        }\n      }\n\n      // If single root editor, unwrap the element from the object.\n      if (isSingleRootEditor(editorType) && 'main' in sourceElementOrData) {\n        sourceElementOrData = sourceElementOrData['main'];\n      }\n\n      // Construct parsed config. First resolve DOM element references in the provided configuration.\n      let resolvedConfig = resolveEditorConfigElementReferences(config);\n\n      // Then resolve translation references in the provided configuration, using the mixed translations.\n      resolvedConfig = resolveEditorConfigTranslations(\n        [...mixedTranslations].reverse(),\n        language.ui,\n        resolvedConfig,\n      );\n\n      const parsedConfig = {\n        ...resolvedConfig,\n        initialData,\n        licenseKey,\n        plugins: loadedPlugins,\n        language,\n        ...mixedTranslations.length && {\n          translations: mixedTranslations,\n        },\n      };\n\n      if (!context || !(sourceElementOrData instanceof HTMLElement)) {\n        return Constructor.create(sourceElementOrData as any, parsedConfig);\n      }\n\n      const result = await createEditorInContext({\n        context,\n        element: sourceElementOrData,\n        creator: Constructor,\n        config: parsedConfig,\n      });\n\n      return result.editor;\n    })();\n\n    if (isSingleRootEditor(editorType) && editableHeight) {\n      setEditorEditableHeight(editor, editableHeight);\n    }\n\n    return editor;\n  };\n}\n\n/**\n * Checks if all required root elements are present in the elements object.\n *\n * @param elements The elements object mapping root IDs to HTMLElements.\n * @param requiredRoots The list of required root IDs.\n * @returns True if all required roots are present, false otherwise.\n */\nfunction checkIfAllRootsArePresent(elements: Record<string, HTMLElement>, requiredRoots: string[]): boolean {\n  return requiredRoots.every(rootId => elements[rootId]);\n}\n\n/**\n * Waits for all required root elements to be present in the DOM.\n *\n * @param editorId The editor's ID.\n * @param requiredRoots The list of required root IDs.\n * @returns A promise that resolves to the record of root elements.\n */\nasync function waitForAllRootsToBePresent(\n  editorId: EditorId,\n  requiredRoots: string[],\n): Promise<Record<string, HTMLElement>> {\n  return waitFor(\n    () => {\n      const elements = queryEditablesElements(editorId) as unknown as Record<string, HTMLElement>;\n\n      if (!checkIfAllRootsArePresent(elements, requiredRoots)) {\n        throw new Error(\n          'It looks like not all required root elements are present yet.\\n'\n          + '* If you want to wait for them, ensure they are registered before editor initialization.\\n'\n          + '* If you want lazy initialize roots, consider removing root values from the `initialData` config '\n          + 'and assign initial data in editable components.\\n'\n          + `Missing roots: ${requiredRoots.filter(rootId => !elements[rootId]).join(', ')}.`,\n        );\n      }\n\n      return elements;\n    },\n    { timeOutAfter: 2000, retryAfter: 100 },\n  );\n}\n","import { CKEditor5SymfonyError } from '../ckeditor5-symfony-error';\nimport { waitForDOMReady } from '../shared';\nimport { EditorsRegistry } from './editor/editors-registry';\nimport { queryAllEditorIds } from './editor/utils';\n\n/**\n * UI Part hook for Symfony. It allows you to create UI parts for multi-root editors.\n */\nexport class UIPartComponentElement extends HTMLElement {\n  /**\n   * The promise that resolves when the UI part is mounted.\n   */\n  private mountedPromise: Promise<void> | null = null;\n\n  /**\n   * Mounts the UI part component.\n   */\n  async connectedCallback() {\n    await waitForDOMReady();\n\n    const editorId = this.getAttribute('data-cke-editor-id') || queryAllEditorIds()[0]!;\n    const name = this.getAttribute('data-cke-name');\n\n    /* v8 ignore next 3 */\n    if (!editorId || !name) {\n      return;\n    }\n\n    // If the editor is not registered yet, we will wait for it to be registered.\n    this.style.display = 'block';\n    this.mountedPromise = EditorsRegistry.the.execute(editorId, (editor) => {\n      if (!this.isConnected) {\n        return;\n      }\n\n      const { ui } = editor;\n\n      const uiViewName = mapUIPartView(name);\n      const uiPart = (ui.view as any)[uiViewName!];\n\n      /* v8 ignore next 3 */\n      if (!uiPart) {\n        throw new CKEditor5SymfonyError(`Unknown UI part name: \"${name}\". Supported names are \"toolbar\" and \"menubar\".`);\n      }\n\n      this.appendChild(uiPart.element);\n    });\n  }\n\n  /**\n   * Destroys the UI part component. Unmounts UI parts from the editor.\n   */\n  async disconnectedCallback() {\n    // Let's hide the element during destruction to prevent flickering.\n    this.style.display = 'none';\n\n    // Let's wait for the mounted promise to resolve before proceeding with destruction.\n    await this.mountedPromise;\n    this.mountedPromise = null;\n\n    // Unmount all UI parts from the editor.\n    this.innerHTML = '';\n  }\n}\n\n/**\n * Maps the UI part name to the corresponding view in the editor.\n *\n * @param name The name of the UI part.\n * @returns The name of the view in the editor.\n */\nfunction mapUIPartView(name: string): string | null {\n  switch (name) {\n    case 'toolbar':\n      return 'toolbar';\n\n    case 'menubar':\n      return 'menuBarView';\n\n    /* v8 ignore next 3 */\n    default:\n      return null;\n  }\n}\n","import { ContextComponentElement } from './context';\nimport { EditableComponentElement } from './editable';\nimport { EditorComponentElement } from './editor';\nimport { UIPartComponentElement } from './ui-part';\n\nconst CUSTOM_ELEMENTS = {\n  'cke5-editor': EditorComponentElement,\n  'cke5-context': ContextComponentElement,\n  'cke5-ui-part': UIPartComponentElement,\n  'cke5-editable': EditableComponentElement,\n};\n\n/**\n * Registers all available Symfony component hooks.\n */\nexport function registerCustomElements() {\n  for (const [name, CustomElement] of Object.entries(CUSTOM_ELEMENTS)) {\n    if (window.customElements.get(name)) {\n      continue;\n    }\n\n    window.customElements.define(name, CustomElement);\n  }\n}\n","import { registerCustomElements } from './elements';\n\nexport { CKEditor5SymfonyError } from './ckeditor5-symfony-error';\nexport { ContextsRegistry } from './elements/context/contexts-registry';\nexport { EditableComponentElement } from './elements/editable';\nexport { EditorComponentElement } from './elements/editor';\nexport { CustomEditorPluginsRegistry } from './elements/editor/custom-editor-plugins';\nexport { EditorsRegistry } from './elements/editor/editors-registry';\nexport { UIPartComponentElement } from './elements/ui-part';\n\nregisterCustomElements();\n"],"names":["AsyncRegistry","id","onSuccess","onError","item","error","resolve","reject","pending","callback","initializationErrors","timeout","exceedTimeout","timer","value","promises","watcher","debounce","delay","timeoutId","args","filterObjectValues","obj","filter","filteredEntries","key","isEmptyObject","mapObjectValues","mapper","mappedEntries","uid","waitFor","timeOutAfter","retryAfter","startTime","lastError","timeoutTimerId","tick","result","err","waitForDOMReady","CONTEXT_EDITOR_WATCHDOG_SYMBOL","createEditorInContext","element","context","creator","config","editorContextId","_element","_config","editor","contextDescriptor","originalDestroy","unwrapEditorContext","getEditorRootsValues","acc","root","isSingleRootEditor","editorType","CKEditor5SymfonyError","message","loadEditorConstructor","type","PKG","EditorConstructor","CustomEditorPluginsRegistry","name","reader","loadEditorPlugins","plugins","basePackage","premiumPackage","loaders","plugin","customPlugin","basePkgImport","premiumPkgImport","loadAllEditorTranslations","language","hasPremium","translations","loadEditorPkgTranslations","pkg","lang","pack","loadEditorTranslation","normalizeCustomTranslations","dictionary","queryAllEditorIds","queryEditablesElements","editorId","editables","queryAllEditorEditables","queryEditablesSnapshotContent","values","content","rootName","currentMain","initialRootEditableValue","contentElement","resolveEditorConfigElementReferences","anyObj","resolveEditorConfigTranslations","getTranslationValue","langData","setEditorEditableHeight","instance","height","editing","writer","EDITOR_WATCHDOG_SYMBOL","wrapWithWatchdog","Editor","EditorWatchdog","watchdog","unwrapEditorWatchdog","ContextsRegistry","ContextComponentElement","contextId","contextConfig","customTranslations","watchdogConfig","loadedPlugins","mixedTranslations","ContextWatchdog","Context","resolvedConfig","EditorsRegistry","EditableComponentElement","saveDebounceMs","input","ui","model","data","editable","sync","html","createDispatchEditorRootsChangeEventPlugin","targetElement","Plugin","createSyncEditorWithInputPlugin","newValue","EditorComponentElement","editorContext","preset","editableHeight","licenseKey","Constructor","wrapped","newInstance","initialData","sourceElementOrData","requiredRoots","checkIfAllRootsArePresent","waitForAllRootsToBePresent","parsedConfig","elements","rootId","UIPartComponentElement","uiViewName","mapUIPartView","uiPart","CUSTOM_ELEMENTS","registerCustomElements","CustomElement"],"mappings":"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QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,QAAS,OAAO,KAAM,QAAO,iCAAiC,EACnE,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,QAAS,OAAO,KAAM,QAAO,iCAAiC,EACnE,IAAK,QAAS,OAAO,KAAM,QAAO,iCAAiC,EACnE,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,QAAS,OAAO,KAAM,QAAO,iCAAiC,EACnE,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK,KAAM,OAAO,KAAM,QAAO,8BAA8B,EAC7D,IAAK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AAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,QAAS,OAAO,KAAM,QAAO,kDAAkD,EACpF,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,UAAW,OAAO,KAAM,QAAO,oDAAoD,EACxF,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,KAAM,OAAO,KAAM,QAAO,+CAA+C,EAC9E,IAAK,QAAS,OAAO,KAAM,QAAO,kDAAkD,EACpF,QACE,eAAQ,KAAK,YAAYA,CAAI,oCAAoC,EAC1D,KAAM,QAAO,+CAA+C,CAAA,CAI3E,OACO9E,EAAO,CACZ,eAAQ,MAAM,kCAAkC6E,CAAG,IAAIC,CAAI,IAAK9E,CAAK,EAC9D,IACT,CACF,CC7NO,SAASiF,EAA4BN,EAAgE,CAC1G,OAAOrD,EAAgBqD,EAAcO,IAAe,CAClD,WAAAA,CAAA,EACA,CACJ,CCdO,SAASC,GAA8B,CAC5C,OAAO,MACJ,KAAK,SAAS,iBAA8B,aAAa,CAAC,EAC1D,IAAI7C,GAAWA,EAAQ,aAAa,oBAAoB,CAAC,EACzD,OAAQ1C,GAAqBA,IAAO,IAAI,CAC7C,CCEO,SAASwF,EAAuBC,EAAoB,CACzD,MAAMC,EAAYC,EAAwBF,CAAQ,EAElD,OAAO/D,EAAgBgE,EAAW,CAAC,CAAE,QAAAhD,CAAA,IAAcA,CAAO,CAC5D,CAUO,SAASkD,EAA8BH,EAAoB,CAChE,MAAMC,EAAYC,EAAwBF,CAAQ,EAC5CI,EAASnE,EAAgBgE,EAAW,CAAC,CAAE,QAAAI,CAAA,IAAcA,CAAO,EAElE,OAAO1E,GAAmByE,EAAQhF,GAAS,OAAOA,GAAU,QAAQ,CACtE,CAYA,SAAS8E,EAAwBF,EAAoB,CACnD,MAAMnC,EACJ,MACG,KAAK,SAAS,iBAA8B,qCAAqCmC,CAAQ,IAAI,CAAC,EAC9F,OAAqC,CAACnC,EAAKZ,IAAY,CACtD,MAAMqD,EAAWrD,EAAQ,aAAa,oBAAoB,EACpDoD,EAAUpD,EAAQ,aAAa,kBAAkB,EAEvDY,OAAAA,EAAIyC,CAAQ,EAAI,CACd,QAASrD,EAAQ,cAA2B,6BAA6B,EACzE,QAAAoD,CAAA,EAGKxC,CACT,EAAG,OAAO,OAAO,CAAA,CAAE,CAAC,EAGlBL,EAAS,SAAS,cAA2B,mCAAmCwC,CAAQ,IAAI,EAGlG,GAAI,CAACxC,EACH,OAAOK,EAGT,MAAM0C,EAAc1C,EAAI,KAClB2C,EAA2B,KAAK,MAAMhD,EAAO,aAAa,kBAAkB,CAAE,EAC9EiD,EAAiB,SAAS,cAA2B,IAAIT,CAAQ,UAAU,EAGjF,OAAIO,GAAeC,GAA2B,KACrC,CACL,GAAG3C,EACH,KAAM,CACJ,GAAG0C,EACH,QAASA,EAAY,SAAWC,EAAyB,IAAM,CACjE,EAKAC,EACK,CACL,GAAG5C,EACH,KAAM,CACJ,QAAS4C,EACT,QAASD,GAA2B,MAAW,IAAA,CACjD,EAIG3C,CACT,CCrFO,SAAS6C,EAAwC9E,EAAW,CACjE,GAAI,CAACA,GAAO,OAAOA,GAAQ,SACzB,OAAOA,EAGT,GAAI,MAAM,QAAQA,CAAG,EACnB,OAAOA,EAAI,IAAIlB,GAAQgG,EAAqChG,CAAI,CAAC,EAGnE,MAAMiG,EAAS/E,EAEf,GAAI+E,EAAO,UAAY,OAAOA,EAAO,UAAa,SAAU,CAC1D,MAAM1D,EAAU,SAAS,cAAc0D,EAAO,QAAQ,EAEtD,OAAK1D,GACH,QAAQ,KAAK,mCAAmC0D,EAAO,QAAQ,EAAE,EAG3D1D,GAAW,IACrB,CAEA,MAAML,EAAS,OAAO,OAAO,IAAI,EAEjC,SAAW,CAACb,EAAKX,CAAK,IAAK,OAAO,QAAQQ,CAAG,EAC3CgB,EAAOb,CAAG,EAAI2E,EAAqCtF,CAAK,EAG1D,OAAOwB,CACT,CCXO,SAASgE,EACdtB,EACAF,EACAxD,EACG,CACH,GAAI,CAACA,GAAO,OAAOA,GAAQ,SACzB,OAAOA,EAGT,GAAI,MAAM,QAAQA,CAAG,EACnB,OAAOA,EAAI,IAAIlB,GAAQkG,EAAgCtB,EAAcF,EAAU1E,CAAI,CAAC,EAGtF,MAAMiG,EAAS/E,EAEf,GAAI+E,EAAO,cAAgB,OAAOA,EAAO,cAAiB,SAAU,CAClE,MAAM5E,EAAc4E,EAAO,aACrBvF,EAAQyF,GAAoBvB,EAAcvD,EAAKqD,CAAQ,EAE7D,OAAIhE,IAAU,QACZ,QAAQ,KAAK,kCAAkCW,CAAG,EAAE,EAG9CX,IAAU,OAAYA,EAAQ,IACxC,CAEA,MAAMwB,EAAS,OAAO,OAAO,IAAI,EAEjC,SAAW,CAACb,EAAKX,CAAK,IAAK,OAAO,QAAQQ,CAAG,EAC3CgB,EAAOb,CAAG,EAAI6E,EAAgCtB,EAAcF,EAAUhE,CAAK,EAG7E,OAAOwB,CACT,CAKA,SAASiE,GACPvB,EACAvD,EACAqD,EAC4C,CAC5C,UAAWM,KAAQJ,EAAc,CAC/B,MAAMwB,EAAWpB,EAAKN,CAAQ,EAE9B,GAAI0B,GAAU,YAAc/E,KAAO+E,EAAS,WAC1C,OAAOA,EAAS,WAAW/E,CAAG,CAElC,CAGF,CCpEO,SAASgF,GAAwBC,EAAkBC,EAAsB,CAC9E,KAAM,CAAE,QAAAC,GAAYF,EAEpBE,EAAQ,KAAK,OAAQC,GAAW,CAC9BA,EAAO,SAAS,SAAU,GAAGF,CAAM,KAAMC,EAAQ,KAAK,SAAS,QAAA,CAAU,CAC3E,CAAC,CACH,CCZA,MAAME,EAAyB,OAAO,IAAI,wBAAwB,EAQlE,eAAsBC,GAAiBC,EAAuB,CAC5D,KAAM,CAAE,eAAAC,CAAA,EAAmB,KAAM,QAAO,WAAW,EAC7CC,EAAW,IAAID,EAAeD,CAAM,EAE1C,OAAAE,EAAS,WAAW,SAAU9F,IAA8C,CAC1E,MAAM8B,EAAS,MAAM8D,EAAO,OAAO,GAAG5F,CAAI,EAEzC,OAAA8B,EAAe4D,CAAsB,EAAII,EAEnChE,CACT,CAAC,EAEM,CACL,SAAAgE,EACA,YAAa,CACX,OAAQ,SAAU9F,KAChB,MAAM8F,EAAS,OAAO,GAAG9F,CAAI,EAEtB8F,EAAS,OAClB,CACF,CAEJ,CAKO,SAASC,GAAqBjE,EAAuC,CAC1E,OAAI4D,KAA0B5D,EACpBA,EAAe4D,CAAsB,EAGxC,IACT,CCpCO,MAAMM,UAAyBpH,CAAwC,CAC5E,OAAgB,IAAM,IAAIoH,CAC5B,CCSO,MAAMC,WAAgC,WAAY,CAI/C,eAA2D,KAKnE,MAAM,mBAAoB,CACxB,MAAM7E,EAAA,EAEN,MAAM8E,EAAY,KAAK,aAAa,qBAAqB,EACnDxC,EAAW,KAAK,MAAM,KAAK,aAAa,mBAAmB,CAAE,EAC7DyC,EAAgB,KAAK,MAAM,KAAK,aAAa,kBAAkB,CAAE,EAEjE,CAAE,mBAAAC,EAAoB,eAAAC,EAAgB,OAAQ,CAAE,QAAApD,EAAS,GAAGvB,CAAA,CAAO,EAAMyE,EACzE,CAAE,cAAAG,EAAe,WAAA3C,CAAA,EAAe,MAAMX,EAAkBC,GAAW,EAAE,EAIrEsD,EAAoB,CACxB,GAFyB,MAAM9C,EAA0BC,EAAUC,CAAU,EAG7EO,EAA4BkC,GAAsB,CAAA,CAAE,CAAA,EAEnD,OAAOxC,GAAgB,CAACtD,EAAcsD,CAAY,CAAC,EAGtD,KAAK,gBAAkB,SAAY,CACjC,KAAM,CAAE,gBAAA4C,EAAiB,QAAAC,GAAY,KAAM,QAAO,WAAW,EAEvDnB,EAAW,IAAIkB,EAAgBC,EAAS,CAC5C,iBAAkB,GAClB,GAAGJ,CAAA,CACJ,EAGD,IAAIK,EAAiB1B,EAAqCtD,CAAM,EAGhE,OAAAgF,EAAiBxB,EACf,CAAC,GAAGqB,CAAiB,EAAE,QAAA,EACvB7C,EAAS,GACTgD,CAAA,EAGF,MAAMpB,EAAS,OAAO,CACpB,GAAGoB,EACH,SAAAhD,EACA,QAAS4C,EACT,GAAGC,EAAkB,QAAU,CAC7B,aAAcA,CAAA,CAChB,CACD,EAEDjB,EAAS,GAAG,YAAa,IAAItF,IAAS,CACpC,QAAQ,MAAM,sBAAuB,GAAGA,CAAI,CAC9C,CAAC,EAEMsF,CACT,GAAA,EAEA,MAAM9D,EAAU,MAAM,KAAK,eAEvB,KAAK,aACPwE,EAAiB,IAAI,SAASE,EAAW1E,CAAO,CAEpD,CAKA,MAAM,sBAAuB,CAC3B,MAAM0E,EAAY,KAAK,aAAa,qBAAqB,EAGzD,KAAK,MAAM,QAAU,OAGrB,GAAI,CAGF,MAFgB,MAAM,KAAK,iBAEZ,QAAA,CACjB,QAAA,CAEE,KAAK,eAAiB,KAElBA,GAAaF,EAAiB,IAAI,QAAQE,CAAS,GACrDF,EAAiB,IAAI,WAAWE,CAAS,CAE7C,CACF,CACF,CCvGO,MAAMS,UAAwB/H,CAAsB,CACzD,OAAgB,IAAM,IAAI+H,CAC5B,CCCO,MAAMC,UAAiC,WAAY,CAIhD,cAAwD,KAKhE,MAAM,mBAAoB,CACxB,MAAMxF,EAAA,EAED,KAAK,aAAa,oBAAoB,GACzC,KAAK,aAAa,qBAAsBgD,EAAA,EAAoB,CAAC,CAAE,EAGjE,MAAME,EAAW,KAAK,aAAa,oBAAoB,EACjDM,EAAW,KAAK,aAAa,oBAAoB,EACjDD,EAAU,KAAK,aAAa,kBAAkB,EAC9CkC,EAAiB,OAAO,SAAS,KAAK,aAAa,2BAA2B,EAAI,EAAE,EAG1F,GAAI,CAACvC,GAAY,CAACM,EAChB,MAAM,IAAIrC,EAAsB,oCAAoC,EAItE,KAAK,MAAM,QAAU,QACrB,KAAK,cAAgBoE,EAAgB,IAAI,QAAQrC,EAAU,MAAOxC,GAA4B,CAC5F,GAAI,CAAC,KAAK,YACR,OAAO,KAGT,MAAMgF,EAAQ,KAAK,cAAc,OAAO,EAClC,CAAE,GAAAC,EAAI,QAAAvB,EAAS,MAAAwB,CAAA,EAAUlF,EAE/B,GAAIkF,EAAM,SAAS,QAAQpC,CAAQ,EAAG,CAGpC,GAAID,IAAY,KAAM,CACpB,MAAMsC,EAAOnF,EAAO,QAAQ,CAAE,SAAA8C,EAAU,EAEpCqC,GAAQA,IAAStC,GACnB7C,EAAO,QAAQ,CACb,CAAC8C,CAAQ,EAAGD,CAAA,CACb,CAEL,CAEA,OAAO7C,CACT,CAEAA,EAAO,QAAQ8C,EAAU,CACvB,WAAY,GACZ,GAAGD,IAAY,MAAQ,CACrB,KAAMA,CAAA,CACR,CACD,EAED,MAAMI,EAAiB,KAAK,cAAc,6BAA6B,EACjEmC,EAAWH,EAAG,KAAK,eAAenC,EAAUG,CAAe,EAEjEgC,EAAG,YAAYG,CAAQ,EACvB1B,EAAQ,KAAK,YAAA,EAGb,MAAM2B,EAAO,IAAM,CACjB,MAAMC,EAAOtF,EAAO,QAAQ,CAAE,SAAA8C,EAAU,EAEpCkC,IACFA,EAAM,MAAQM,EACdN,EAAM,cAAc,IAAI,MAAM,OAAO,CAAC,GAGxC,KAAK,cAAc,IAAI,YAAY,SAAU,CAAE,OAAQ,CAAE,MAAOM,CAAA,CAAK,CAAG,CAAC,CAC3E,EAEA,OAAAtF,EAAO,MAAM,SAAS,GAAG,cAAejC,EAASgH,EAAgBM,CAAI,CAAC,EACtEA,EAAA,EAEOrF,CACT,CAAC,CACH,CAKA,MAAM,sBAAuB,CAC3B,MAAM8C,EAAW,KAAK,aAAa,oBAAoB,EAGvD,KAAK,MAAM,QAAU,OAGrB,MAAM9C,EAAS,MAAM,KAAK,cAI1B,GAHA,KAAK,cAAgB,KAGjBA,GAAUA,EAAO,QAAU,aAAe8C,EAAU,CACtD,MAAMxC,EAAON,EAAO,MAAM,SAAS,QAAQ8C,CAAQ,EAEnD,GAAIxC,GAAQ,mBAAoBN,EAAQ,CACtC,GAAI,CACFA,EAAO,eAAeM,CAAI,CAC5B,OACOjB,EAAK,CAEV,QAAQ,MAAM,qCAAsCA,CAAG,CACzD,CAEAW,EAAO,WAAW8C,EAAU,EAAK,CACnC,CACF,CACF,CACF,CCpHA,eAAsByC,GACpB,CACE,eAAAR,EACA,SAAAvC,EACA,cAAAgD,CACF,EAC4B,CAC5B,KAAM,CAAE,OAAAC,CAAA,EAAW,KAAM,QAAO,WAAW,EAE3C,OAAO,cAA6CA,CAAO,CAIzD,WAAW,YAAa,CACtB,MAAO,gCACT,CAKO,WAAkB,CACvB,MAAMJ,EAAOtH,EAASgH,EAAgB,KAAK,QAAQ,EAEnD,KAAK,OAAO,MAAM,SAAS,GAAG,cAAeM,CAAI,EACjD,KAAK,OAAO,KAAK,QAAS,KAAK,QAAQ,CACzC,CAKQ,SAAW,IAAY,CAC7BG,EAAc,cACZ,IAAI,YAAY,wBAAyB,CACvC,OAAQ,CACN,SAAAhD,EACA,OAAQ,KAAK,OACb,MAAOpC,GAAqB,KAAK,MAAM,CAAA,EAEzC,QAAS,EAAA,CACV,CAAA,CAEL,CAAA,CAEJ,CC5CA,eAAsBsF,GAAgCX,EAAoD,CACxG,KAAM,CAAE,OAAAU,CAAA,EAAW,KAAM,QAAO,WAAW,EAE3C,OAAO,cAAkCA,CAAO,CAItC,MAAiC,KAKjC,KAA+B,KAKvC,WAAW,YAAa,CACtB,MAAO,qBACT,CAKO,WAAkB,CACvB,KAAM,CAAE,OAAAzF,GAAW,KAIbwC,EAHiBxC,EAAyB,cAGjB,GAAG,QAAQ,WAAY,EAAE,EAExD,KAAK,MAAQ,SAAS,eAAe,GAAGwC,CAAQ,QAAQ,EAEnD,KAAK,QAKVxC,EAAO,MAAM,SAAS,GAAG,cAAejC,EAASgH,EAAgB,IAAM,KAAK,KAAA,CAAM,CAAC,EACnF/E,EAAO,KAAK,QAAS,KAAK,IAAI,EAG9B,KAAK,KAAO,KAAK,MAAM,QAAQ,MAAM,EACrC,KAAK,MAAM,iBAAiB,SAAU,KAAK,IAAI,EACjD,CAKQ,KAAO,IAAY,CACzB,GAAI,KAAK,MAAO,CACd,MAAM2F,EAAW,KAAK,OAAO,QAAA,EAE7B,KAAK,MAAM,MAAQA,EACnB,KAAK,MAAM,cAAc,IAAI,MAAM,QAAS,CAAE,QAAS,EAAA,CAAM,CAAC,CAChE,CACF,EAKgB,SAAgB,CAC1B,KAAK,MACP,KAAK,KAAK,oBAAoB,SAAU,KAAK,IAAI,EAGnD,KAAK,MAAQ,KACb,KAAK,KAAO,IACd,CAAA,CAEJ,CC7CO,MAAMC,UAA+B,WAAY,CAI9C,cAAwC,KAKhD,MAAM,mBAAmC,CACvC,MAAMtG,EAAA,EAEN,MAAMkD,EAAW,KAAK,aAAa,oBAAoB,EAEvDqC,EAAgB,IAAI,YAAYrC,CAAQ,EAExC,GAAI,CACF,KAAK,MAAM,QAAU,QACrB,KAAK,cAAgB,KAAK,aAAA,EAE1B,MAAMxC,EAAS,MAAM,KAAK,cAItB,KAAK,cACP6E,EAAgB,IAAI,SAASrC,EAAUxC,CAAM,EAE7CA,EAAO,KAAK,UAAW,IAAM,CACvB6E,EAAgB,IAAI,QAAQrC,CAAQ,GACtCqC,EAAgB,IAAI,WAAWrC,CAAQ,CAE3C,CAAC,EAGL,OACOrF,EAAY,CACjB,QAAQ,MAAM,kDAAkDqF,CAAQ,KAAMrF,CAAK,EACnF,KAAK,cAAgB,KACrB0H,EAAgB,IAAI,MAAMrC,EAAUrF,CAAK,CAC3C,CACF,CAMA,MAAM,sBAAuB,CAE3B,KAAK,MAAM,QAAU,OAGrB,GAAI,CACF,MAAM6C,EAAS,MAAM,KAAK,cAG1B,GAAI,CAACA,EACH,OAGF,MAAM6F,EAAgB1F,GAAoBH,CAAM,EAC1CgE,EAAWC,GAAqBjE,CAAM,EAExC6F,EAGEA,EAAc,QAAU,eAC1B,MAAMA,EAAc,QAAQ,OAAOA,EAAc,eAAe,EAG3D7B,EACP,MAAMA,EAAS,QAAA,EAGf,MAAMhE,EAAO,QAAA,CAEjB,QAAA,CAEE,KAAK,cAAgB,IACvB,CACF,CAKA,MAAc,cAAe,CAC3B,MAAMwC,EAAW,KAAK,aAAa,oBAAoB,EACjDsD,EAAS,KAAK,MAAM,KAAK,aAAa,iBAAiB,CAAE,EACzD1B,EAAY,KAAK,aAAa,qBAAqB,EACnD2B,EAAiB,KAAK,aAAa,0BAA0B,EAAI,OAAO,SAAS,KAAK,aAAa,0BAA0B,EAAI,EAAE,EAAI,KACvIhB,EAAiB,OAAO,SAAS,KAAK,aAAa,2BAA2B,EAAI,EAAE,EACpFnD,EAAW,KAAK,MAAM,KAAK,aAAa,mBAAmB,CAAE,EAC7DoC,EAAW,KAAK,aAAa,mBAAmB,EAChDnB,EAAU,KAAK,MAAM,KAAK,aAAa,kBAAkB,CAAE,EAE3D,CACJ,mBAAAyB,EACA,WAAA9D,EACA,WAAAwF,EACA,OAAQ,CAAE,QAAA7E,EAAS,GAAGvB,CAAA,CAAO,EAC3BkG,EAGJ,IAAIG,EAA6B,MAAMtF,GAAsBH,CAAU,EACvE,MAAMd,EAAU,MACd0E,EACIF,EAAiB,IAAI,QAAQE,CAAS,EACtC,MAIN,GAAIJ,GAAY,CAACtE,EAAS,CACxB,MAAMwG,EAAU,MAAMrC,GAAiBoC,CAAW,GAEjD,CAAE,YAAAA,GAAgBC,GACnBA,EAAQ,SAAS,GAAG,UAAW,IAAM,CACnC,MAAMC,EAAcD,EAAQ,SAAS,OAErC,KAAK,cAAgB,QAAQ,QAAQC,CAAW,EAEhDtB,EAAgB,IAAI,SAASrC,EAAU2D,CAAW,CACpD,CAAC,CACH,CAEA,KAAM,CAAE,cAAA3B,EAAe,WAAA3C,CAAA,EAAe,MAAMX,EAAkBC,CAAO,EAErEqD,EAAc,KACZ,MAAMe,GAA2C,CAC/C,eAAAR,EACA,SAAAvC,EACA,cAAe,IAAA,CAChB,CAAA,EAGCjC,EAAmBC,CAAU,GAC/BgE,EAAc,KACZ,MAAMkB,GAAgCX,CAAc,CAAA,EAMxD,MAAMN,EAAoB,CACxB,GAFyB,MAAM9C,EAA0BC,EAAUC,CAAU,EAG7EO,EAA4BkC,GAAsB,CAAA,CAAE,CAAA,EAEnD,OAAOxC,GAAgB,CAACtD,EAAcsD,CAAY,CAAC,EAGtD,IAAIsE,EAA+C,CACjD,GAAGvD,EACH,GAAGF,EAA8BH,CAAQ,CAAA,EAGvCjC,EAAmBC,CAAU,IAC/B4F,EAAcA,EAAY,MAAW,IAIvC,MAAMpG,EAAS,MAAO,SAAY,CAChC,IAAIqG,EAAiE9D,EAAuBC,CAAQ,EAIpG,GAAI,CAAC6D,EAAoB,KAAS,CAChC,MAAMC,EACJ/F,EAAmBC,CAAU,EACzB,CAAC,MAAM,EACP,OAAO,KAAK4F,CAAqC,EAGlDG,EAA0BF,EAAqBC,CAAa,IAC/DD,EAAsB,MAAMG,GAA2BhE,EAAU8D,CAAa,EAC9EF,EAAc,CACZ,GAAGvD,EACH,GAAGF,EAA8BH,CAAQ,CAAA,EAG/C,CAGIjC,EAAmBC,CAAU,GAAK,SAAU6F,IAC9CA,EAAsBA,EAAoB,MAI5C,IAAIzB,EAAiB1B,EAAqCtD,CAAM,EAGhEgF,EAAiBxB,EACf,CAAC,GAAGqB,CAAiB,EAAE,QAAA,EACvB7C,EAAS,GACTgD,CAAA,EAGF,MAAM6B,EAAe,CACnB,GAAG7B,EACH,YAAAwB,EACA,WAAAJ,EACA,QAASxB,EACT,SAAA5C,EACA,GAAG6C,EAAkB,QAAU,CAC7B,aAAcA,CAAA,CAChB,EAGF,MAAI,CAAC/E,GAAW,EAAE2G,aAA+B,aACxCJ,EAAY,OAAOI,EAA4BI,CAAY,GAGrD,MAAMjH,GAAsB,CACzC,QAAAE,EACA,QAAS2G,EACT,QAASJ,EACT,OAAQQ,CAAA,CACT,GAEa,MAChB,GAAA,EAEA,OAAIlG,EAAmBC,CAAU,GAAKuF,GACpCxC,GAAwBvD,EAAQ+F,CAAc,EAGzC/F,CACT,CACF,CASA,SAASuG,EAA0BG,EAAuCJ,EAAkC,CAC1G,OAAOA,EAAc,MAAMK,GAAUD,EAASC,CAAM,CAAC,CACvD,CASA,eAAeH,GACbhE,EACA8D,EACsC,CACtC,OAAOzH,GACL,IAAM,CACJ,MAAM6H,EAAWnE,EAAuBC,CAAQ,EAEhD,GAAI,CAAC+D,EAA0BG,EAAUJ,CAAa,EACpD,MAAM,IAAI,MACR;AAAA;AAAA;AAAA,iBAIoBA,EAAc,OAAOK,GAAU,CAACD,EAASC,CAAM,CAAC,EAAE,KAAK,IAAI,CAAC,GAAA,EAIpF,OAAOD,CACT,EACA,CAAE,aAAc,IAAM,WAAY,GAAA,CAAI,CAE1C,CCnSO,MAAME,UAA+B,WAAY,CAI9C,eAAuC,KAK/C,MAAM,mBAAoB,CACxB,MAAMtH,EAAA,EAEN,MAAMkD,EAAW,KAAK,aAAa,oBAAoB,GAAKF,EAAA,EAAoB,CAAC,EAC3EtB,EAAO,KAAK,aAAa,eAAe,EAG1C,CAACwB,GAAY,CAACxB,IAKlB,KAAK,MAAM,QAAU,QACrB,KAAK,eAAiB6D,EAAgB,IAAI,QAAQrC,EAAWxC,GAAW,CACtE,GAAI,CAAC,KAAK,YACR,OAGF,KAAM,CAAE,GAAAiF,GAAOjF,EAET6G,EAAaC,GAAc9F,CAAI,EAC/B+F,EAAU9B,EAAG,KAAa4B,CAAW,EAG3C,GAAI,CAACE,EACH,MAAM,IAAItG,EAAsB,0BAA0BO,CAAI,iDAAiD,EAGjH,KAAK,YAAY+F,EAAO,OAAO,CACjC,CAAC,EACH,CAKA,MAAM,sBAAuB,CAE3B,KAAK,MAAM,QAAU,OAGrB,MAAM,KAAK,eACX,KAAK,eAAiB,KAGtB,KAAK,UAAY,EACnB,CACF,CAQA,SAASD,GAAc9F,EAA6B,CAClD,OAAQA,EAAA,CACN,IAAK,UACH,MAAO,UAET,IAAK,UACH,MAAO,cAGT,QACE,OAAO,IAAA,CAEb,CC9EA,MAAMgG,GAAkB,CACtB,cAAepB,EACf,eAAgBzB,GAChB,eAAgByC,EAChB,gBAAiB9B,CACnB,EAKO,SAASmC,IAAyB,CACvC,SAAW,CAACjG,EAAMkG,CAAa,IAAK,OAAO,QAAQF,EAAe,EAC5D,OAAO,eAAe,IAAIhG,CAAI,GAIlC,OAAO,eAAe,OAAOA,EAAMkG,CAAa,CAEpD,CCbAD,GAAA"}